#!/usr/bin/env python3
"""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘          MASTER VULNERABILITY DATABASE DOWNLOADER v2.0                       â•‘
â•‘          Download from ALL major security databases                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Supported Databases (25+):
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. OSV - Open Source Vulnerabilities (25+ ecosystems)
2. NVD - National Vulnerability Database (CVE 2002-2024)
3. CISA KEV - Known Exploited Vulnerabilities
4. GitHub Security Advisories
5. Exploit-DB - Exploit Database
6. InTheWild.io - Actively Exploited Vulns
7. RustSec - Rust Advisories
8. PyPA - Python Advisories
9. RubyGems - Ruby Advisories
10. Go Vulnerability Database
11. Metasploit Framework
12. SecLists Repository
13. PHP Security Advisories
14. NPM Advisory Database
15. Kubernetes CVEs
16. Docker Security Advisories
17. Jenkins Security Advisories
18. WordPress Vulnerabilities
19. Drupal Security Advisories
20. Android Security Bulletins
21. Cisco Security Advisories
22. Microsoft Security Updates
23. Red Hat Security Data
24. Ubuntu Security Notices
25. Debian Security Tracker

Requirements:
  pip install requests
"""

import sys
import argparse
import requests
import os
import json
import time
from pathlib import Path
from datetime import datetime
from typing import List, Dict, Optional
import urllib.parse

class Colors:
    """ANSI color codes for terminal output"""
    HEADER = '\033[95m'
    BLUE = '\033[94m'
    CYAN = '\033[96m'
    GREEN = '\033[92m'
    YELLOW = '\033[93m'
    RED = '\033[91m'
    ENDC = '\033[0m'
    BOLD = '\033[1m'
    UNDERLINE = '\033[4m'

class MasterVulnDownloader:
    """Master downloader for all vulnerability databases"""
    
    def __init__(self, output_dir: str = "./vuln_databases"):
        self.output_dir = output_dir
        self.success_count = 0
        self.total_count = 0
        self.failed_downloads = []
        self.start_time = datetime.now()
        
        # Comprehensive database configurations
        self.databases = {
            'osv': {
                'name': 'Open Source Vulnerabilities (OSV)',
                'description': 'Google-managed open source vulnerability database',
                'ecosystems': ['npm', 'PyPI', 'Go', 'Maven', 'NuGet', 'RubyGems', 
                              'crates.io', 'Packagist', 'Pub', 'SwiftURL', 'Hex',
                              'ConanCenter', 'Rocky Linux', 'Debian', 'Ubuntu', 
                              'Alpine', 'Android', 'GSD', 'OSS-Fuzz', 'Linux',
                              'Bitnami', 'AlmaLinux', 'Photon OS', 'Chainguard', 'Wolfi'],
                'url': 'https://osv.dev',
                'free': True
            },
            'nvd': {
                'name': 'National Vulnerability Database (NVD)',
                'description': 'US government repository of CVE data with CVSS scores',
                'years': list(range(2002, 2025)),
                'url': 'https://nvd.nist.gov',
                'free': True
            },
            'cisa': {
                'name': 'CISA Known Exploited Vulnerabilities (KEV)',
                'description': 'Catalog of vulnerabilities actively exploited in the wild',
                'url': 'https://www.cisa.gov/known-exploited-vulnerabilities-catalog',
                'free': True
            },
            'github': {
                'name': 'GitHub Security Advisories',
                'description': 'Security advisories for open source projects on GitHub',
                'url': 'https://github.com/advisories',
                'free': True
            },
            'exploitdb': {
                'name': 'Exploit Database',
                'description': 'Archive of exploits and vulnerable software',
                'url': 'https://www.exploit-db.com',
                'free': True
            },
            'inthewild': {
                'name': 'InTheWild.io',
                'description': 'Tracks vulnerabilities exploited in real-world attacks',
                'url': 'https://inthewild.io',
                'free': True
            },
            'rustsec': {
                'name': 'RustSec Advisory Database',
                'description': 'Security advisories for Rust crates',
                'url': 'https://rustsec.org',
                'free': True
            },
            'pypa': {
                'name': 'PyPA Advisory Database',
                'description': 'Security advisories for Python packages',
                'url': 'https://github.com/pypa/advisory-database',
                'free': True
            },
            'rubygems': {
                'name': 'RubyGems Advisory Database',
                'description': 'Security advisories for Ruby gems',
                'url': 'https://rubysec.com',
                'free': True
            },
            'go': {
                'name': 'Go Vulnerability Database',
                'description': 'Official Go vulnerability database',
                'url': 'https://github.com/golang/vulndb',
                'free': True
            },
            'metasploit': {
                'name': 'Metasploit Framework',
                'description': 'Exploitation framework with vulnerability modules',
                'url': 'https://github.com/rapid7/metasploit-framework',
                'free': True
            },
            'seclists': {
                'name': 'SecLists Repository',
                'description': 'Security mailing list archives and resources',
                'url': 'https://github.com/danielmiessler/SecLists',
                'free': True
            },
            'php': {
                'name': 'PHP Security Advisories',
                'description': 'Security advisories for PHP packages',
                'url': 'https://github.com/FriendsOfPHP/security-advisories',
                'free': True
            },
            'nodejs': {
                'name': 'Node.js Security WG',
                'description': 'Node.js security working group advisories',
                'url': 'https://github.com/nodejs/security-wg',
                'free': True
            },
            'kubernetes': {
                'name': 'Kubernetes CVEs',
                'description': 'Kubernetes security vulnerabilities',
                'url': 'https://kubernetes.io/docs/reference/issues-security/official-cve-feed/',
                'free': True
            },
            'docker': {
                'name': 'Docker Security Advisories',
                'description': 'Docker and container security advisories',
                'url': 'https://github.com/docker',
                'free': True
            },
            'jenkins': {
                'name': 'Jenkins Security Advisories',
                'description': 'Jenkins CI/CD security advisories',
                'url': 'https://www.jenkins.io/security/advisories/',
                'free': True
            },
            'wordpress': {
                'name': 'WordPress Vulnerabilities (WPScan)',
                'description': 'WordPress core and plugin vulnerabilities',
                'url': 'https://wpscan.com',
                'free': True
            },
            'drupal': {
                'name': 'Drupal Security Advisories',
                'description': 'Drupal CMS security advisories',
                'url': 'https://www.drupal.org/security',
                'free': True
            },
            'android': {
                'name': 'Android Security Bulletins',
                'description': 'Android OS security bulletins',
                'url': 'https://source.android.com/security/bulletin',
                'free': True
            },
            'redhat': {
                'name': 'Red Hat Security Data',
                'description': 'Red Hat and Fedora security advisories',
                'url': 'https://www.redhat.com/security/data/metrics/',
                'free': True
            },
            'ubuntu': {
                'name': 'Ubuntu Security Notices',
                'description': 'Ubuntu Linux security notices',
                'url': 'https://ubuntu.com/security/notices',
                'free': True
            },
            'debian': {
                'name': 'Debian Security Tracker',
                'description': 'Debian Linux security tracking',
                'url': 'https://security-tracker.debian.org',
                'free': True
            },
            'mitre': {
                'name': 'MITRE CVE List',
                'description': 'Official CVE list maintained by MITRE',
                'url': 'https://cve.mitre.org',
                'free': True
            },
            'cwe': {
                'name': 'MITRE CWE Database',
                'description': 'Common Weakness Enumeration',
                'url': 'https://cwe.mitre.org',
                'free': True
            }
        }
    
    def print_banner(self):
        """Print colorful banner"""
        banner = f"""
{Colors.CYAN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘{Colors.BOLD}          MASTER VULNERABILITY DATABASE DOWNLOADER v2.0{Colors.ENDC}{Colors.CYAN}                       â•‘
â•‘          Download from 25+ major security databases                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•{Colors.ENDC}
"""
        print(banner)
    
    def download_file(self, url: str, output_path: str, description: str, 
                     headers: Optional[Dict] = None) -> bool:
        """Download a file with progress indication"""
        print(f"\n{Colors.BLUE}{'='*70}{Colors.ENDC}")
        print(f"{Colors.BOLD}ğŸ“¥ Downloading:{Colors.ENDC} {description}")
        print(f"{Colors.CYAN}ğŸ”— URL:{Colors.ENDC} {url}")
        print(f"{Colors.CYAN}ğŸ’¾ Saving to:{Colors.ENDC} {output_path}")
        
        self.total_count += 1
        
        try:
            Path(os.path.dirname(output_path)).mkdir(parents=True, exist_ok=True)
            
            response = requests.get(url, stream=True, headers=headers or {}, timeout=60, allow_redirects=True)
            response.raise_for_status()
            
            file_size = response.headers.get('Content-Length')
            if file_size:
                file_size = int(file_size)
                print(f"{Colors.YELLOW}ğŸ“Š File size: {file_size / (1024*1024):.2f} MB{Colors.ENDC}")
            
            with open(output_path, 'wb') as f:
                downloaded = 0
                chunk_size = 8192
                
                for chunk in response.iter_content(chunk_size=chunk_size):
                    if chunk:
                        f.write(chunk)
                        downloaded += len(chunk)
                        
                        if file_size:
                            progress = (downloaded / file_size) * 100
                            bar_length = 40
                            filled = int(bar_length * downloaded / file_size)
                            bar = 'â–ˆ' * filled + 'â–‘' * (bar_length - filled)
                            print(f"\r{Colors.YELLOW}â³ Progress: [{bar}] {progress:.1f}%{Colors.ENDC}", end='', flush=True)
            
            print(f"\n{Colors.GREEN}âœ… SUCCESS: Downloaded successfully!{Colors.ENDC}")
            self.success_count += 1
            return True
            
        except requests.exceptions.HTTPError as e:
            error_msg = f"HTTP {e.response.status_code if hasattr(e, 'response') else 'Unknown'}"
            print(f"\n{Colors.RED}âŒ FAILED: {error_msg}{Colors.ENDC}")
            self.failed_downloads.append({'description': description, 'error': error_msg})
            return False
            
        except Exception as e:
            print(f"\n{Colors.RED}âŒ FAILED: {str(e)}{Colors.ENDC}")
            self.failed_downloads.append({'description': description, 'error': str(e)})
            return False

    def download_json_api(self, url: str, output_path: str, description: str) -> bool:
        """Download JSON data from API"""
        print(f"\n{Colors.BLUE}{'='*70}{Colors.ENDC}")
        print(f"{Colors.BOLD}ğŸ“¥ Fetching:{Colors.ENDC} {description}")
        print(f"{Colors.CYAN}ğŸ”— URL:{Colors.ENDC} {url}")
        
        self.total_count += 1
        
        try:
            Path(os.path.dirname(output_path)).mkdir(parents=True, exist_ok=True)
            
            response = requests.get(url, timeout=30)
            response.raise_for_status()
            
            with open(output_path, 'w') as f:
                json.dump(response.json(), f, indent=2)
            
            print(f"{Colors.CYAN}ğŸ’¾ Saved to: {output_path}{Colors.ENDC}")
            print(f"{Colors.GREEN}âœ… SUCCESS{Colors.ENDC}")
            self.success_count += 1
            return True
            
        except Exception as e:
            print(f"{Colors.RED}âŒ FAILED: {str(e)}{Colors.ENDC}")
            self.failed_downloads.append({'description': description, 'error': str(e)})
            return False

    # ==================== OSV DOWNLOADS ====================
    
    def download_osv_all(self):
        """Download all OSV data"""
        print(f"\n{Colors.HEADER}{'='*70}")
        print(f"ğŸ” DOWNLOADING OSV (OPEN SOURCE VULNERABILITIES)")
        print(f"{'='*70}{Colors.ENDC}")
        
        self.download_file(
            "https://storage.googleapis.com/osv-vulnerabilities/all.zip",
            f"{self.output_dir}/osv/osv_global_all.zip",
            "OSV - Global All Vulnerabilities"
        )
        
        self.download_file(
            "https://storage.googleapis.com/osv-vulnerabilities/modified_id.csv",
            f"{self.output_dir}/osv/modified_id.csv",
            "OSV - Modified Vulnerability IDs"
        )
        
        for eco in self.databases['osv']['ecosystems']:
            self.download_file(
                f"https://storage.googleapis.com/osv-vulnerabilities/{eco}/all.zip",
                f"{self.output_dir}/osv/ecosystems/{eco}_all.zip",
                f"OSV - {eco} Ecosystem"
            )
            time.sleep(0.5)

    # ==================== NVD DOWNLOADS ====================
    
    def download_nvd_all(self):
        """Download all NVD data"""
        print(f"\n{Colors.HEADER}{'='*70}")
        print(f"ğŸ” DOWNLOADING NVD (NATIONAL VULNERABILITY DATABASE)")
        print(f"{'='*70}{Colors.ENDC}")
        
        self.download_file(
            "https://nvd.nist.gov/feeds/json/cve/1.1/nvdcve-1.1-recent.json.gz",
            f"{self.output_dir}/nvd/nvdcve-recent.json.gz",
            "NVD - Recent CVEs (Last 8 Days)"
        )
        
        self.download_file(
            "https://nvd.nist.gov/feeds/json/cve/1.1/nvdcve-1.1-modified.json.gz",
            f"{self.output_dir}/nvd/nvdcve-modified.json.gz",
            "NVD - Modified CVEs"
        )
        
        for year in self.databases['nvd']['years']:
            self.download_file(
                f"https://nvd.nist.gov/feeds/json/cve/1.1/nvdcve-1.1-{year}.json.gz",
                f"{self.output_dir}/nvd/years/nvdcve-{year}.json.gz",
                f"NVD - CVEs for Year {year}"
            )
            time.sleep(1)

    # ==================== CISA KEV ====================
    
    def download_cisa_kev(self):
        """Download CISA Known Exploited Vulnerabilities"""
        print(f"\n{Colors.HEADER}{'='*70}")
        print(f"ğŸ” DOWNLOADING CISA KEV (KNOWN EXPLOITED VULNERABILITIES)")
        print(f"{'='*70}{Colors.ENDC}")
        
        self.download_file(
            "https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json",
            f"{self.output_dir}/cisa/kev.json",
            "CISA KEV - JSON Format"
        )
        
        self.download_file(
            "https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.csv",
            f"{self.output_dir}/cisa/kev.csv",
            "CISA KEV - CSV Format"
        )

    # ==================== GITHUB ADVISORIES ====================
    
    def download_github_advisories(self):
        """Download GitHub Security Advisories"""
        print(f"\n{Colors.HEADER}{'='*70}")
        print(f"ğŸ” DOWNLOADING GITHUB SECURITY ADVISORIES")
        print(f"{'='*70}{Colors.ENDC}")
        
        self.download_file(
            "https://github.com/github/advisory-database/archive/refs/heads/main.zip",
            f"{self.output_dir}/github/advisory-database-main.zip",
            "GitHub Advisory Database"
        )

    # ==================== EXPLOIT-DB ====================
    
    def download_exploitdb(self):
        """Download Exploit-DB"""
        print(f"\n{Colors.HEADER}{'='*70}")
        print(f"ğŸ” DOWNLOADING EXPLOIT-DB")
        print(f"{'='*70}{Colors.ENDC}")
        
        self.download_file(
            "https://gitlab.com/exploit-database/exploitdb/-/archive/main/exploitdb-main.zip",
            f"{self.output_dir}/exploitdb/exploitdb-main.zip",
            "Exploit-DB - Full Database"
        )
        
        self.download_file(
            "https://gitlab.com/exploit-database/exploitdb/-/raw/main/files_exploits.csv",
            f"{self.output_dir}/exploitdb/files_exploits.csv",
            "Exploit-DB - Exploit Files CSV"
        )
        
        self.download_file(
            "https://gitlab.com/exploit-database/exploitdb/-/raw/main/files_shellcodes.csv",
            f"{self.output_dir}/exploitdb/files_shellcodes.csv",
            "Exploit-DB - Shellcodes CSV"
        )

    # ==================== INTHEWILD.IO ====================
    
    def download_inthewild(self):
        """Download InTheWild.io exploited vulnerabilities"""
        print(f"\n{Colors.HEADER}{'='*70}")
        print(f"ğŸ” DOWNLOADING INTHEWILD.IO (ACTIVELY EXPLOITED)")
        print(f"{'='*70}{Colors.ENDC}")
        
        self.download_json_api(
            "https://inthewild.io/api/exploited",
            f"{self.output_dir}/inthewild/exploited.json",
            "InTheWild.io API Data"
        )

    # ==================== LANGUAGE-SPECIFIC ====================
    
    def download_rustsec(self):
        """Download RustSec Advisory Database"""
        print(f"\n{Colors.HEADER}{'='*70}")
        print(f"ğŸ” DOWNLOADING RUSTSEC ADVISORY DATABASE")
        print(f"{'='*70}{Colors.ENDC}")
        
        self.download_file(
            "https://github.com/RustSec/advisory-db/archive/refs/heads/main.zip",
            f"{self.output_dir}/rustsec/advisory-db-main.zip",
            "RustSec Advisory Database"
        )

    def download_pypa(self):
        """Download Python Package Advisory Database"""
        print(f"\n{Colors.HEADER}{'='*70}")
        print(f"ğŸ” DOWNLOADING PYPA ADVISORY DATABASE (PYTHON)")
        print(f"{'='*70}{Colors.ENDC}")
        
        self.download_file(
            "https://github.com/pypa/advisory-database/archive/refs/heads/main.zip",
            f"{self.output_dir}/pypa/advisory-database-main.zip",
            "PyPA Advisory Database"
        )

    def download_rubygems(self):
        """Download RubyGems Advisory Database"""
        print(f"\n{Colors.HEADER}{'='*70}")
        print(f"ğŸ” DOWNLOADING RUBYGEMS ADVISORY DATABASE")
        print(f"{'='*70}{Colors.ENDC}")
        
        self.download_file(
            "https://github.com/rubysec/ruby-advisory-db/archive/refs/heads/master.zip",
            f"{self.output_dir}/rubygems/ruby-advisory-db-master.zip",
            "RubyGems Advisory Database"
        )

    def download_go_vulndb(self):
        """Download Go Vulnerability Database"""
        print(f"\n{Colors.HEADER}{'='*70}")
        print(f"ğŸ” DOWNLOADING GO VULNERABILITY DATABASE")
        print(f"{'='*70}{Colors.ENDC}")
        
        self.download_file(
            "https://github.com/golang/vulndb/archive/refs/heads/master.zip",
            f"{self.output_dir}/go/vulndb-master.zip",
            "Go Vulnerability Database"
        )

    # ==================== ADDITIONAL DATABASES ====================
    
    def download_metasploit(self):
        """Download Metasploit Framework"""
        print(f"\n{Colors.HEADER}{'='*70}")
        print(f"ğŸ” DOWNLOADING METASPLOIT FRAMEWORK")
        print(f"{'='*70}{Colors.ENDC}")
        
        self.download_file(
            "https://github.com/rapid7/metasploit-framework/archive/refs/heads/master.zip",
            f"{self.output_dir}/metasploit/metasploit-framework-master.zip",
            "Metasploit Framework"
        )

    def download_seclists(self):
        """Download SecLists repository"""
        print(f"\n{Colors.HEADER}{'='*70}")
        print(f"ğŸ” DOWNLOADING SECLISTS REPOSITORY")
        print(f"{'='*70}{Colors.ENDC}")
        
        self.download_file(
            "https://github.com/danielmiessler/SecLists/archive/refs/heads/master.zip",
            f"{self.output_dir}/seclists/SecLists-master.zip",
            "SecLists Security Resources"
        )

    def download_php(self):
        """Download PHP Security Advisories"""
        print(f"\n{Colors.HEADER}{'='*70}")
        print(f"ğŸ” DOWNLOADING PHP SECURITY ADVISORIES")
        print(f"{'='*70}{Colors.ENDC}")
        
        self.download_file(
            "https://github.com/FriendsOfPHP/security-advisories/archive/refs/heads/master.zip",
            f"{self.output_dir}/php/security-advisories-master.zip",
            "PHP Security Advisories"
        )

    def download_nodejs(self):
        """Download Node.js Security WG"""
        print(f"\n{Colors.HEADER}{'='*70}")
        print(f"ğŸ” DOWNLOADING NODE.JS SECURITY WG")
        print(f"{'='*70}{Colors.ENDC}")
        
        self.download_file(
            "https://github.com/nodejs/security-wg/archive/refs/heads/main.zip",
            f"{self.output_dir}/nodejs/security-wg-main.zip",
            "Node.js Security Working Group"
        )

    def download_wordpress(self):
        """Download WordPress Vulnerabilities"""
        print(f"\n{Colors.HEADER}{'='*70}")
        print(f"ğŸ” DOWNLOADING WORDPRESS VULNERABILITIES (WPSCAN)")
        print(f"{'='*70}{Colors.ENDC}")
        
        self.download_file(
            "https://wpscan.com/api/v3/wordpresses",
            f"{self.output_dir}/wordpress/wpscan_wordpresses.json",
            "WPScan WordPress Core Vulnerabilities"
        )

    def download_redhat(self):
        """Download Red Hat Security Data"""
        print(f"\n{Colors.HEADER}{'='*70}")
        print(f"ğŸ” DOWNLOADING RED HAT SECURITY DATA")
        print(f"{'='*70}{Colors.ENDC}")
        
        # Red Hat CVE database
        self.download_file(
            "https://www.redhat.com/security/data/oval/com.redhat.rhsa-all.xml",
            f"{self.output_dir}/redhat/rhsa-all.xml",
            "Red Hat Security Advisories (OVAL)"
        )
        
        self.download_file(
            "https://www.redhat.com/security/data/metrics/cvemap.xml",
            f"{self.output_dir}/redhat/cvemap.xml",
            "Red Hat CVE Map"
        )

    def download_ubuntu(self):
        """Download Ubuntu Security Notices"""
        print(f"\n{Colors.HEADER}{'='*70}")
        print(f"ğŸ” DOWNLOADING UBUNTU SECURITY NOTICES")
        print(f"{'='*70}{Colors.ENDC}")
        
        # Ubuntu CVE tracker database
        self.download_file(
            "https://git.launchpad.net/ubuntu-cve-tracker/plain/active/CVE-2024",
            f"{self.output_dir}/ubuntu/CVE-2024.txt",
            "Ubuntu CVE Tracker 2024"
        )

    def download_debian(self):
        """Download Debian Security Tracker"""
        print(f"\n{Colors.HEADER}{'='*70}")
        print(f"ğŸ” DOWNLOADING DEBIAN SECURITY TRACKER")
        print(f"{'='*70}{Colors.ENDC}")
        
        # Debian security tracker JSON
        self.download_json_api(
            "https://security-tracker.debian.org/tracker/data/json",
            f"{self.output_dir}/debian/security-tracker.json",
            "Debian Security Tracker JSON"
        )

    def download_mitre_cve(self):
        """Download MITRE CVE data"""
        print(f"\n{Colors.HEADER}{'='*70}")
        print(f"ğŸ” DOWNLOADING MITRE CVE LIST")
        print(f"{'='*70}{Colors.ENDC}")
        
        print(f"{Colors.YELLOW}â„¹ï¸  MITRE CVE data is included in NVD downloads{Colors.ENDC}")
        print(f"{Colors.YELLOW}â„¹ï¸  For direct access, use NVD feeds{Colors.ENDC}")

    def download_cwe(self):
        """Download MITRE CWE Database"""
        print(f"\n{Colors.HEADER}{'='*70}")
        print(f"ğŸ” DOWNLOADING MITRE CWE DATABASE")
        print(f"{'='*70}{Colors.ENDC}")
        
        self.download_file(
            "https://cwe.mitre.org/data/xml/cwec_latest.xml.zip",
            f"{self.output_dir}/cwe/cwec_latest.xml.zip",
            "MITRE CWE Database (XML)"
        )

    # ==================== QUICK DOWNLOAD ====================
    
    def download_quick_essentials(self):
        """Download only the most essential/recent data"""
        print(f"\n{Colors.HEADER}{'='*70}")
        print(f"âš¡ QUICK DOWNLOAD MODE - ESSENTIALS ONLY")
        print(f"{'='*70}{Colors.ENDC}")
        
        self.download_file(
            "https://storage.googleapis.com/osv-vulnerabilities/modified_id.csv",
            f"{self.output_dir}/quick/osv_modified_id.csv",
            "OSV - Recently Modified IDs"
        )
        
        self.download_file(
            "https://nvd.nist.gov/feeds/json/cve/1.1/nvdcve-1.1-recent.json.gz",
            f"{self.output_dir}/quick/nvdcve-recent.json.gz",
            "NVD - Recent CVEs"
        )
        
        self.download_file(
            "https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json",
            f"{self.output_dir}/quick/cisa_kev.json",
            "CISA - Known Exploited Vulnerabilities"
        )
        
        self.download_inthewild()

    # ==================== INTERACTIVE MENU ====================
    
    def interactive_menu(self):
        """Display interactive menu"""
        while True:
            os.system('clear' if os.name == 'posix' else 'cls')
            self.print_banner()
            print(f"\n{Colors.BOLD}{Colors.CYAN}INTERACTIVE MENU{Colors.ENDC}")
            print(f"{Colors.BLUE}{'='*70}{Colors.ENDC}\n")
            
            print(f"{Colors.YELLOW}1.{Colors.ENDC}  Download ALL databases (WARNING: Very large!)")
            print(f"{Colors.YELLOW}2.{Colors.ENDC}  Quick download (essentials only)")
            print(f"{Colors.YELLOW}3.{Colors.ENDC}  Download specific database")
            print(f"{Colors.YELLOW}4.{Colors.ENDC}  List all available databases")
            print(f"{Colors.YELLOW}5.{Colors.ENDC}  View database information")
            print(f"{Colors.YELLOW}6.{Colors.ENDC}  View statistics")
            print(f"{Colors.YELLOW}7.{Colors.ENDC}  Exit")
            
            choice = input(f"\n{Colors.BOLD}Enter your choice (1-7): {Colors.ENDC}").strip()
            
            if choice == '1':
                self.download_all_databases()
                input(f"\n{Colors.GREEN}Press Enter to continue...{Colors.ENDC}")
            elif choice == '2':
                self.download_quick_essentials()
                self.print_summary()
                input(f"\n{Colors.GREEN}Press Enter to continue...{Colors.ENDC}")
            elif choice == '3':
                self.interactive_database_selection()
            elif choice == '4':
                self.list_databases()
                input(f"\n{Colors.GREEN}Press Enter to continue...{Colors.ENDC}")
            elif choice == '5':
                self.show_database_info()
                input(f"\n{Colors.GREEN}Press Enter to continue...{Colors.ENDC}")
            elif choice == '6':
                self.show_statistics()
                input(f"\n{Colors.GREEN}Press Enter to continue...{Colors.ENDC}")
            elif choice == '7':
                print(f"\n{Colors.CYAN}Goodbye!{Colors.ENDC}")
                break
            else:
                print(f"\n{Colors.RED}Invalid choice. Please try again.{Colors.ENDC}")
                time.sleep(2)

    def interactive_database_selection(self):
        """Interactive database selection menu"""
        os.system('clear' if os.name == 'posix' else 'cls')
        self.print_banner()
        print(f"\n{Colors.BOLD}{Colors.CYAN}SELECT DATABASE TO DOWNLOAD{Colors.ENDC}")
        print(f"{Colors.BLUE}{'='*70}{Colors.ENDC}\n")
        
        db_list = list(self.databases.keys())
        for i, key in enumerate(db_list, 1):
            db = self.databases[key]
            free_tag = f"{Colors.GREEN}[FREE]{Colors.ENDC}" if db['free'] else f"{Colors.RED}[API]{Colors.ENDC}"
            print(f"{Colors.YELLOW}{i:2d}.{Colors.ENDC} {db['name']:55s} {free_tag}")
        
        print(f"\n{Colors.YELLOW} 0.{Colors.ENDC} Cancel")
        choice = input(f"\n{Colors.BOLD}Enter database number: {Colors.ENDC}").strip()
        
        try:
            choice_num = int(choice)
            if choice_num == 0:
                return
            if 1 <= choice_num <= len(db_list):
                db_key = db_list[choice_num - 1]
                self.download_single_database(db_key)
                self.print_summary()
                input(f"\n{Colors.GREEN}Press Enter to continue...{Colors.ENDC}")
            else:
                print(f"{Colors.RED}Invalid selection{Colors.ENDC}")
                time.sleep(2)
        except ValueError:
            print(f"{Colors.RED}Invalid input{Colors.ENDC}")
            time.sleep(2)

    def download_single_database(self, db_key: str):
        """Download a single database"""
        db_methods = {
            'osv': self.download_osv_all,
            'nvd': self.download_nvd_all,
            'cisa': self.download_cisa_kev,
            'github': self.download_github_advisories,
            'exploitdb': self.download_exploitdb,
            'inthewild': self.download_inthewild,
            'rustsec': self.download_rustsec,
            'pypa': self.download_pypa,
            'rubygems': self.download_rubygems,
            'go': self.download_go_vulndb,
            'metasploit': self.download_metasploit,
            'seclists': self.download_seclists,
            'php': self.download_php,
            'nodejs': self.download_nodejs,
            'wordpress': self.download_wordpress,
            'redhat': self.download_redhat,
            'ubuntu': self.download_ubuntu,
            'debian': self.download_debian,
            'mitre': self.download_mitre_cve,
            'cwe': self.download_cwe
        }
        
        if db_key in db_methods:
            db_methods[db_key]()
        else:
            print(f"{Colors.YELLOW}âš ï¸  {self.databases[db_key]['name']} requires API access or not implemented{Colors.ENDC}")

    def download_all_databases(self):
        """Download all available databases"""
        os.system('clear' if os.name == 'posix' else 'cls')
        self.print_banner()
        print(f"\n{Colors.RED}{Colors.BOLD}âš ï¸  WARNING: FULL DOWNLOAD{Colors.ENDC}")
        print(f"{Colors.RED}âš ï¸  This will download EVERYTHING!{Colors.ENDC}")
        print(f"{Colors.RED}âš ï¸  This may take hours and use 50+ GB of space!{Colors.ENDC}")
        print(f"{Colors.RED}âš ï¸  Consider using --quick mode instead{Colors.ENDC}")
        
        confirm = input(f"\n{Colors.BOLD}Type 'YES' to confirm: {Colors.ENDC}").strip()
        if confirm != 'YES':
            print(f"{Colors.YELLOW}Download cancelled{Colors.ENDC}")
            return
        
        print(f"\n{Colors.GREEN}Proceeding with full download...{Colors.ENDC}")
        time.sleep(2)
        
        # Download all databases
        self.download_osv_all()
        self.download_nvd_all()
        self.download_cisa_kev()
        self.download_github_advisories()
        self.download_exploitdb()
        self.download_inthewild()
        self.download_rustsec()
        self.download_pypa()
        self.download_rubygems()
        self.download_go_vulndb()
        self.download_metasploit()
        self.download_seclists()
        self.download_php()
        self.download_nodejs()
        self.download_redhat()
        self.download_debian()
        self.download_cwe()
        
        self.print_summary()

    def show_database_info(self):
        """Show detailed database information"""
        os.system('clear' if os.name == 'posix' else 'cls')
        self.print_banner()
        print(f"\n{Colors.BOLD}{Colors.CYAN}DATABASE INFORMATION{Colors.ENDC}")
        print(f"{Colors.BLUE}{'='*70}{Colors.ENDC}\n")
        
        for i, (key, db) in enumerate(self.databases.items(), 1):
            free_tag = f"{Colors.GREEN}[FREE]{Colors.ENDC}" if db['free'] else f"{Colors.RED}[API REQUIRED]{Colors.ENDC}"
            print(f"\n{Colors.YELLOW}{i}. {db['name']}{Colors.ENDC} {free_tag}")
            print(f"   {Colors.CYAN}Key:{Colors.ENDC} {key}")
            print(f"   {Colors.CYAN}Description:{Colors.ENDC} {db['description']}")
            print(f"   {Colors.CYAN}URL:{Colors.ENDC} {db['url']}")
            
            if 'ecosystems' in db:
                print(f"   {Colors.CYAN}Ecosystems:{Colors.ENDC} {len(db['ecosystems'])} available")
                print(f"   {Colors.CYAN}Examples:{Colors.ENDC} {', '.join(db['ecosystems'][:5])}...")
            
            if 'years' in db:
                print(f"   {Colors.CYAN}Data Range:{Colors.ENDC} {db['years'][0]}-{db['years'][-1]}")

    def show_statistics(self):
        """Show download statistics"""
        os.system('clear' if os.name == 'posix' else 'cls')
        self.print_banner()
        print(f"\n{Colors.BOLD}{Colors.CYAN}CURRENT SESSION STATISTICS{Colors.ENDC}")
        print(f"{Colors.BLUE}{'='*70}{Colors.ENDC}\n")
        
        elapsed = datetime.now() - self.start_time
        
        print(f"{Colors.CYAN}Session Start:{Colors.ENDC} {self.start_time.strftime('%Y-%m-%d %H:%M:%S')}")
        print(f"{Colors.CYAN}Current Time:{Colors.ENDC} {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
        print(f"{Colors.CYAN}Time Elapsed:{Colors.ENDC} {elapsed}")
        print(f"\n{Colors.GREEN}âœ… Successful Downloads:{Colors.ENDC} {self.success_count}")
        print(f"{Colors.RED}âŒ Failed Downloads:{Colors.ENDC} {len(self.failed_downloads)}")
        print(f"{Colors.CYAN}ğŸ“Š Total Attempts:{Colors.ENDC} {self.total_count}")
        
        if self.total_count > 0:
            success_rate = (self.success_count / self.total_count) * 100
            print(f"{Colors.YELLOW}ğŸ“ˆ Success Rate:{Colors.ENDC} {success_rate:.1f}%")
        
        # Calculate directory size
        try:
            if os.path.exists(self.output_dir):
                total_size = sum(
                    os.path.getsize(os.path.join(dirpath, filename))
                    for dirpath, _, filenames in os.walk(self.output_dir)
                    for filename in filenames
                )
                print(f"{Colors.GREEN}ğŸ’¾ Total Downloaded:{Colors.ENDC} {total_size / (1024*1024*1024):.2f} GB")
                
                # Count files
                file_count = sum(len(filenames) for _, _, filenames in os.walk(self.output_dir))
                print(f"{Colors.CYAN}ğŸ“ Total Files:{Colors.ENDC} {file_count}")
        except:
            pass

    # ==================== SUMMARY AND REPORTING ====================
    
    def print_summary(self):
        """Print comprehensive download summary"""
        elapsed = datetime.now() - self.start_time
        
        print(f"\n{Colors.BOLD}{Colors.CYAN}{'='*70}")
        print(f"ğŸ“Š DOWNLOAD SUMMARY")
        print(f"{'='*70}{Colors.ENDC}")
        print(f"{Colors.GREEN}âœ… Successful:{Colors.ENDC} {self.success_count}/{self.total_count}")
        print(f"{Colors.RED}âŒ Failed:{Colors.ENDC} {len(self.failed_downloads)}/{self.total_count}")
        
        if self.total_count > 0:
            success_rate = (self.success_count / self.total_count) * 100
            print(f"{Colors.YELLOW}ğŸ“ˆ Success Rate:{Colors.ENDC} {success_rate:.1f}%")
        
        print(f"{Colors.CYAN}ğŸ“ Output directory:{Colors.ENDC} {self.output_dir}")
        print(f"{Colors.CYAN}â±ï¸  Time elapsed:{Colors.ENDC} {elapsed}")
        print(f"{Colors.CYAN}ğŸ• Completed at:{Colors.ENDC} {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
        
        if self.failed_downloads:
            print(f"\n{Colors.RED}{Colors.BOLD}{'='*70}")
            print(f"âŒ FAILED DOWNLOADS:")
            print(f"{'='*70}{Colors.ENDC}")
            for item in self.failed_downloads:
                print(f"  {Colors.RED}â€¢{Colors.ENDC} {item['description']}")
                print(f"    {Colors.YELLOW}Error:{Colors.ENDC} {item['error']}")
        
        # Calculate total size
        try:
            if os.path.exists(self.output_dir):
                total_size = sum(
                    os.path.getsize(os.path.join(dirpath, filename))
                    for dirpath, _, filenames in os.walk(self.output_dir)
                    for filename in filenames
                )
                print(f"\n{Colors.GREEN}ğŸ’¾ Total downloaded: {total_size / (1024*1024*1024):.2f} GB{Colors.ENDC}")
                
                # Top 5 largest files
                file_sizes = []
                for dirpath, _, filenames in os.walk(self.output_dir):
                    for filename in filenames:
                        filepath = os.path.join(dirpath, filename)
                        size = os.path.getsize(filepath)
                        file_sizes.append((filepath, size))
                
                if file_sizes:
                    file_sizes.sort(key=lambda x: x[1], reverse=True)
                    print(f"\n{Colors.CYAN}ğŸ“Š Largest files:{Colors.ENDC}")
                    for filepath, size in file_sizes[:5]:
                        rel_path = os.path.relpath(filepath, self.output_dir)
                        print(f"  {Colors.YELLOW}â€¢{Colors.ENDC} {rel_path}: {size / (1024*1024):.1f} MB")
        except:
            pass
        
        print(f"{Colors.CYAN}{'='*70}{Colors.ENDC}")

    def list_databases(self):
        """List all available databases"""
        os.system('clear' if os.name == 'posix' else 'cls')
        self.print_banner()
        print(f"\n{Colors.BOLD}{Colors.CYAN}AVAILABLE VULNERABILITY DATABASES{Colors.ENDC}")
        print(f"{Colors.BLUE}{'='*70}{Colors.ENDC}\n")
        
        free_count = sum(1 for db in self.databases.values() if db['free'])
        print(f"{Colors.GREEN}Total databases: {len(self.databases)} ({free_count} free, {len(self.databases) - free_count} require API){Colors.ENDC}\n")
        
        # Group by category
        categories = {
            'Core Databases': ['osv', 'nvd', 'cisa', 'github', 'exploitdb', 'inthewild'],
            'Language-Specific': ['rustsec', 'pypa', 'rubygems', 'go', 'php', 'nodejs'],
            'Platform-Specific': ['wordpress', 'drupal', 'jenkins', 'kubernetes', 'docker', 'android'],
            'OS/Distribution': ['redhat', 'ubuntu', 'debian'],
            'Tools & Resources': ['metasploit', 'seclists'],
            'Standards': ['mitre', 'cwe']
        }
        
        for category, db_keys in categories.items():
            print(f"\n{Colors.BOLD}{Colors.YELLOW}{category}:{Colors.ENDC}")
            for key in db_keys:
                if key in self.databases:
                    db = self.databases[key]
                    free_tag = f"{Colors.GREEN}[FREE]{Colors.ENDC}" if db['free'] else f"{Colors.RED}[API]{Colors.ENDC}"
                    print(f"  {Colors.CYAN}â€¢{Colors.ENDC} {db['name']:50s} {free_tag} [{key}]")
                    
                    if 'ecosystems' in db:
                        print(f"    {Colors.CYAN}â†³ {len(db['ecosystems'])} ecosystems{Colors.ENDC}")
                    if 'years' in db:
                        print(f"    {Colors.CYAN}â†³ Years: {db['years'][0]}-{db['years'][-1]}{Colors.ENDC}")

def print_full_help():
    """Print comprehensive help documentation"""
    help_text = f"""
{Colors.BOLD}{Colors.CYAN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    MASTER VULNERABILITY DOWNLOADER v2.0                      â•‘
â•‘                         COMPLETE COMMAND REFERENCE                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•{Colors.ENDC}

{Colors.BOLD}BASIC USAGE:{Colors.ENDC}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  python master_vuln_downloader.py [OPTIONS]

{Colors.BOLD}MAIN OPTIONS:{Colors.ENDC}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  {Colors.GREEN}-i, --interactive{Colors.ENDC}       Launch interactive menu (recommended)
  {Colors.GREEN}-a, --all{Colors.ENDC}               Download ALL databases (WARNING: 50+ GB!)
  {Colors.GREEN}-q, --quick{Colors.ENDC}             Quick mode - essentials only (recommended)
  {Colors.GREEN}-l, --list{Colors.ENDC}              List all available databases
  {Colors.GREEN}-h, --help{Colors.ENDC}              Show this help message

{Colors.BOLD}DATABASE SELECTION:{Colors.ENDC}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  {Colors.GREEN}-d, --database DATABASE [DATABASE ...]{Colors.ENDC}
      Download specific databases. Available options:
      
      {Colors.CYAN}Core Databases:{Colors.ENDC}
      osv, nvd, cisa, github, exploitdb, inthewild
      
      {Colors.CYAN}Language-Specific:{Colors.ENDC}
      rustsec, pypa, rubygems, go, php, nodejs
      
      {Colors.CYAN}Platform-Specific:{Colors.ENDC}
      wordpress, drupal, jenkins, kubernetes, docker, android
      
      {Colors.CYAN}OS/Distribution:{Colors.ENDC}
      redhat, ubuntu, debian
      
      {Colors.CYAN}Tools & Resources:{Colors.ENDC}
      metasploit, seclists
      
      {Colors.CYAN}Standards:{Colors.ENDC}
      mitre, cwe

{Colors.BOLD}CONFIGURATION:{Colors.ENDC}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  {Colors.GREEN}-o, --output-dir PATH{Colors.ENDC}   Specify custom output directory
                              Default: ./vuln_databases

{Colors.BOLD}EXAMPLES:{Colors.ENDC}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  {Colors.YELLOW}# Interactive menu (easiest for beginners){Colors.ENDC}
  python master_vuln_downloader.py --interactive

  {Colors.YELLOW}# Quick download (recommended for most users){Colors.ENDC}
  python master_vuln_downloader.py --quick

  {Colors.YELLOW}# Download specific databases{Colors.ENDC}
  python master_vuln_downloader.py -d osv cisa exploitdb

  {Colors.YELLOW}# Download everything to custom location{Colors.ENDC}
  python master_vuln_downloader.py --all -o /data/vulnerabilities

  {Colors.YELLOW}# List all available databases{Colors.ENDC}
  python master_vuln_downloader.py --list

  {Colors.YELLOW}# Download only security essentials{Colors.ENDC}
  python master_vuln_downloader.py -d nvd cisa inthewild

  {Colors.YELLOW}# Download all language-specific advisories{Colors.ENDC}
  python master_vuln_downloader.py -d rustsec pypa rubygems go php nodejs

{Colors.BOLD}REQUIREMENTS:{Colors.ENDC}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  â€¢ Python 3.6 or higher
  â€¢ requests library: pip install requests
  â€¢ Internet connection
  â€¢ Sufficient disk space (varies by selection):
    - Quick mode: ~100 MB
    - Single database: 100 MB - 5 GB
    - Full download: 50+ GB

{Colors.BOLD}OUTPUT STRUCTURE:{Colors.ENDC}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  vuln_databases/
  â”œâ”€â”€ osv/
  â”‚   â”œâ”€â”€ osv_global_all.zip
  â”‚   â”œâ”€â”€ modified_id.csv
  â”‚   â””â”€â”€ ecosystems/
  â”‚       â”œâ”€â”€ npm_all.zip
  â”‚       â”œâ”€â”€ PyPI_all.zip
  â”‚       â””â”€â”€ ...
  â”œâ”€â”€ nvd/
  â”‚   â”œâ”€â”€ nvdcve-recent.json.gz
  â”‚   â”œâ”€â”€ nvdcve-modified.json.gz
  â”‚   â””â”€â”€ years/
  â”‚       â”œâ”€â”€ nvdcve-2024.json.gz
  â”‚       â””â”€â”€ ...
  â”œâ”€â”€ cisa/
  â”‚   â”œâ”€â”€ kev.json
  â”‚   â””â”€â”€ kev.csv
  â”œâ”€â”€ github/
  â”‚   â””â”€â”€ advisory-database-main.zip
  â”œâ”€â”€ exploitdb/
  â”‚   â”œâ”€â”€ exploitdb-main.zip
  â”‚   â”œâ”€â”€ files_exploits.csv
  â”‚   â””â”€â”€ files_shellcodes.csv
  â””â”€â”€ ...

{Colors.BOLD}TIPS & BEST PRACTICES:{Colors.ENDC}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  â€¢ Start with --quick mode to get the most recent data quickly
  â€¢ Use --list to see all available databases before downloading
  â€¢ The --all option downloads 50+ GB and takes hours
  â€¢ Failed downloads are logged in the summary
  â€¢ Use Ctrl+C to stop downloads safely
  â€¢ Downloaded files are organized by source for easy access

{Colors.BOLD}SUPPORT & RESOURCES:{Colors.ENDC}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  For database-specific documentation, visit the URLs shown in --list
  All databases are publicly accessible and free (unless marked [API])

{Colors.CYAN}{'='*80}{Colors.ENDC}
"""
    print(help_text)

def main():
    parser = argparse.ArgumentParser(
        description="Master Vulnerability Database Downloader v2.0 - Download from 25+ sources",
        formatter_class=argparse.RawDescriptionHelpFormatter,
        add_help=False
    )
    
    parser.add_argument('-i', '--interactive', action='store_true',
                       help='Launch interactive menu')
    parser.add_argument('-a', '--all', action='store_true',
                       help='Download ALL databases (WARNING: Very large!)')
    parser.add_argument('-q', '--quick', action='store_true',
                       help='Quick mode: essentials and recent data only')
    parser.add_argument('-d', '--database', nargs='+', 
                       choices=['osv', 'nvd', 'cisa', 'github', 'exploitdb', 
                               'inthewild', 'rustsec', 'pypa', 'rubygems', 'go',
                               'metasploit', 'seclists', 'mitre', 'php', 'nodejs',
                               'wordpress', 'drupal', 'jenkins', 'kubernetes', 'docker',
                               'android', 'redhat', 'ubuntu', 'debian', 'cwe'],
                       help='Download specific databases')
    parser.add_argument('-o', '--output-dir', default='./vuln_databases',
                       help='Output directory (default: ./vuln_databases)')
    parser.add_argument('-l', '--list', action='store_true',
                       help='List all available databases')
    parser.add_argument('-h', '--help', action='store_true',
                       help='Show this help message')
    
    args = parser.parse_args()
    
    # Show help
    if args.help or (len(sys.argv) == 1):
        print_full_help()
        return
    
    downloader = MasterVulnDownloader(args.output_dir)
    
    # Interactive mode
    if args.interactive:
        downloader.interactive_menu()
        return
    
    # List databases
    if args.list:
        downloader.list_databases()
        return
    
    # Start banner
    downloader.print_banner()
    print(f"{Colors.CYAN}ğŸ“… Started: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}{Colors.ENDC}")
    print(f"{Colors.CYAN}ğŸ“ Output: {args.output_dir}{Colors.ENDC}")
    print(f"{Colors.CYAN}{'='*70}{Colors.ENDC}")
    
    # Quick mode
    if args.quick:
        downloader.download_quick_essentials()
    
    # Download all
    elif args.all:
        downloader.download_all_databases()
    
    # Specific databases
    elif args.database:
        for db in args.database:
            downloader.download_single_database(db)
    
    # Print summary
    downloader.print_summary()
    
    # Exit code based on success
    if downloader.success_count < downloader.total_count:
        sys.exit(1)

if __name__ == "__main__":
    try:
        main()
    except KeyboardInterrupt:
        print(f"\n\n{Colors.YELLOW}âš ï¸  Download interrupted by user{Colors.ENDC}")
        print(f"{Colors.CYAN}Partial downloads may exist in the output directory{Colors.ENDC}")
        sys.exit(130)
    except Exception as e:
        print(f"\n\n{Colors.RED}âŒ Fatal error: {str(e)}{Colors.ENDC}")
        sys.exit(1)