# =============================================================================
# ULTIMATE 2025 PENETRATION TESTING TOOLKIT - COMPLETE COMBINED EDITION
# EVERYTHING FROM BOTH SCRIPTS - FULL INSTALLATION + GUI MANAGEMENT
# Run as Administrator for complete functionality
# =============================================================================

# Check for Administrator privileges
if (-NOT ([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator")) {
    Write-Host "‚ùå Please run this script as Administrator!" -ForegroundColor Red
    Write-Host "Right-click PowerShell and select 'Run as Administrator'" -ForegroundColor Yellow
    exit
}

Add-Type -AssemblyName System.Windows.Forms
Add-Type -AssemblyName System.Drawing
Add-Type -AssemblyName System.Security
Add-Type -AssemblyName System.Net.Http
Add-Type -AssemblyName System.IO.Compression
Add-Type -AssemblyName System.IO.Compression.FileSystem
Add-Type -AssemblyName Microsoft.VisualBasic
[System.Windows.Forms.Application]::EnableVisualStyles()

# ========== GLOBAL VARIABLES ==========
$Script:OutputTextBox = $null
$Script:MainForm = $null
$Script:InstallStatus = @{}
$Script:ScanResults = @()
$Script:CurrentTarget = ""
$Script:ActiveSessions = @()
$Script:LiveScans = @()
$Script:CrackedHashes = @()
$Script:NetworkDiscovery = @()
$Script:Payloads = @{}
$Script:ToolStatus = @{}
$Script:VulnerabilityFindings = @()
$Script:ExploitSessions = @()
$Script:PasswordHashes = @()
$Script:WirelessNetworks = @()
$Script:WebAppFindings = @()
$Script:PrivEscVectors = @()
$Script:SocialEngineeringTemplates = @()
$Script:PersistenceMethods = @()
$Script:ReverseShells = @()
$Script:WebShells = @{}
$Script:ReportData = @{}

$Script:ToolsDir = "C:\PenTestTools"
$Script:BinDir = "$Script:ToolsDir\bin"

$Script:UserSettings = @{
    DefaultOutputDir = "$env:USERPROFILE\Desktop\Pentest_Results"
    MaxThreads = 10
    DefaultPortRange = "1-1000"
    ScanDelay = 100
    EnableLogging = $true
}

# ========== COMPLETE TOOL DEFINITIONS ==========
$Script:AllTools = @{
    # Network Scanning
    "Nmap" = @("Network", "Network discovery and security auditing")
    "Wireshark" = @("Network", "Network protocol analyzer") 
    "Masscan" = @("Network", "Mass IP port scanner")
    "AngryIPScanner" = @("Network", "IP address and port scanner")
    "Zenmap" = @("Network", "Nmap GUI frontend")
    "Netcat" = @("Network", "Network utility for reading/writing network connections")
    "Tcpdump" = @("Network", "Command-line packet analyzer")
    "Ettercap" = @("Network", "Network sniffer and MITM attacks")
    
    # Web Application Testing
    "Burp Suite" = @("Web", "Web application security testing")
    "ZAP" = @("Web", "OWASP Zed Attack Proxy")
    "Sqlmap" = @("Web", "SQL injection tool")
    "Nikto" = @("Web", "Web server scanner")
    "GoBuster" = @("Web", "Directory/file & DNS busting tool")
    "Dirb" = @("Web", "Web content scanner")
    "Fiddler" = @("Web", "Web debugging proxy")
    "Postman" = @("Web", "API development environment")
    "SoapUI" = @("Web", "Web service testing")
    
    # Password Cracking
    "John" = @("Cracker", "Password cracker")
    "Hashcat" = @("Cracker", "Advanced password recovery")
    "Hydra" = @("Cracker", "Network logon cracker")
    "Ophcrack" = @("Cracker", "Windows password cracker")
    "Cain" = @("Cracker", "Password recovery tool")
    
    # Exploitation
    "Metasploit" = @("Exploitation", "Penetration testing framework")
    
    # Wireless
    "Aircrack-ng" = @("Wireless", "WiFi security auditing")
    
    # Development
    "Python" = @("Language", "Programming language for security tools")
    "Git" = @("Utility", "Version control system")
    "Go" = @("Language", "Go programming language")
    "Ruby" = @("Language", "Ruby programming language")
    "Node.js" = @("Language", "JavaScript runtime")
    "VSCode" = @("Development", "Code editor")
    "Golang" = @("Language", "Go programming language")
    "CMake" = @("Development", "Build system")
    "Mingw" = @("Development", "Minimalist GNU for Windows")
    "Vim" = @("Development", "Text editor")
    "SublimeText" = @("Development", "Text editor")
    "VisualStudioBuildTools" = @("Development", "Microsoft build tools")
    
    # Reconnaissance
    "Nuclei" = @("Recon", "Vulnerability scanner based on templates")
    "Subfinder" = @("Recon", "Subdomain discovery tool")
    "Amass" = @("Recon", "In-depth DNS enumeration and mapping")
    "TheHarvester" = @("Recon", "Email, subdomain and name scraper")
    "Recon-ng" = @("Recon", "Web reconnaissance framework")
    "Maltego" = @("Recon", "Link analysis and data mining tool")
    "Shodan" = @("Recon", "Search engine for Internet-connected devices")
    "Dnsenum" = @("Recon", "DNS enumeration tool")
    "Dnsrecon" = @("Recon", "DNS enumeration tool")
    "Sublist3r" = @("Recon", "Subdomain enumeration tool")
    "Netdiscover" = @("Recon", "Network address discovery tool")
    "Hping3" = @("Recon", "Network probing and testing tool")
    "Snmpcheck" = @("Recon", "SNMP enumeration tool")
    "Onesixtyone" = @("Recon", "SNMP scanner")
    "Enum4linux" = @("Recon", "Windows/Samba enumeration tool")
    "Smbclient" = @("Recon", "SMB/CIFS client")
    "Rpcscan" = @("Recon", "RPC enumeration tool")
    "Snmpwalk" = @("Recon", "SNMP enumeration tool")
    "Nbtscan" = @("Recon", "NetBIOS name scanner")
    
    # Utilities
    "7zip" = @("Utility", "File archiver")
    "Notepad++" = @("Utility", "Text editor")
    "Putty" = @("Utility", "SSH and telnet client")
    "WinSCP" = @("Utility", "SFTP and FTP client")
    "OpenVPN" = @("Utility", "VPN client")
    "ProxyChains" = @("Utility", "Proxy tool")
    "Tor" = @("Utility", "Anonymous browsing")
    "mRemoteNG" = @("Utility", "Remote connections manager")
    "RDM" = @("Utility", "Remote desktop manager")
    "HexEditor" = @("Utility", "Hex editor")
    "Curl" = @("Utility", "Command-line HTTP client")
    "Wget" = @("Utility", "Command-line HTTP client")
    "Jq" = @("Utility", "JSON processor")
    "Grep" = @("Utility", "Text search")
    "Sed" = @("Utility", "Text stream editor")
    "Awk" = @("Utility", "Text processing")
    "Yara" = @("Utility", "Pattern matching")
    
    # Forensics & Reverse Engineering
    "Sysinternals" = @("Forensics", "Windows system utilities")
    "Autopsy" = @("Forensics", "Digital forensics platform")
    "Ghidra" = @("Reverse", "Software reverse engineering suite")
    "x64dbg" = @("Reverse", "Debugger for Windows")
    "ProcessHacker" = @("Forensics", "Process viewer")
    "PEStudio" = @("Reverse", "PE file analyzer")
    "Volatility" = @("Forensics", "Memory forensics framework")
    "dnSpy" = @("Reverse", ".NET debugger and assembly editor")
    "IDA" = @("Reverse", "Interactive disassembler")
    "WinDbg" = @("Reverse", "Windows debugger")
    "BinText" = @("Reverse", "Text extractor")
    
    # Database Tools
    "MySQL" = @("Database", "MySQL database")
    "MySQLWorkbench" = @("Database", "MySQL GUI tool")
    "PostgreSQL" = @("Database", "PostgreSQL database")
    "MongoDB" = @("Database", "NoSQL database")
    "SQLite" = @("Database", "SQLite database")
    
    # Vulnerability Scanners
    "Nessus" = @("Vulnerability", "Vulnerability scanner")
    "OpenVAS" = @("Vulnerability", "Vulnerability management system")
    "WPScan" = @("Web", "WordPress security scanner")
    "JoomScan" = @("Web", "Joomla security scanner")
    "DrupalScan" = @("Web", "Drupal security scanner")
    "RetireJS" = @("Web", "JavaScript vulnerability scanner")
    "Sslyze" = @("Crypto", "SSL/TLS configuration scanner")
    "TestSSL" = @("Crypto", "SSL/TLS cryptographic checker")
    
    # Post-Exploitation
    "Empire" = @("PostExploit", "Post-exploitation framework")
    "BeEF" = @("Exploitation", "Browser Exploitation Framework")
    "SET" = @("Social", "Social Engineering Toolkit")
    "PowerSploit" = @("PostExploit", "PowerShell penetration testing framework")
    "CobaltStrike" = @("PostExploit", "Adversary simulation framework")
    "Sliver" = @("PostExploit", "Cross-platform adversary emulation")
    "BloodHound" = @("PostExploit", "Active Directory relationship analyzer")
    "Mimikatz" = @("PostExploit", "Windows credential extraction")
    
    # Additional Tools
    "Medusa" = @("Cracker", "Parallel network login auditor")
    "Ncrack" = @("Cracker", "High-speed network authentication cracking")
    "Patator" = @("Cracker", "Multi-purpose brute-forcer")
    "HashID" = @("Cracker", "Hash type identifier")
    "Crunch" = @("Cracker", "Wordlist generator")
    "Cewl" = @("Cracker", "Custom wordlist generator")
    "Pyrit" = @("Wireless", "WPA/WPA2-PSK cracking tool")
    "Cowpatty" = @("Wireless", "WPA-PSK cracking tool")
    "RainbowCrack" = @("Cracker", "Password hash cracker using rainbow tables")
    "OclHashcat" = @("Cracker", "GPU-accelerated password recovery")
    "Dirbuster" = @("Web", "Directory and file brute forcer")
    "Wfuzz" = @("Web", "Web application fuzzer")
    "Ffuf" = @("Web", "Fast web fuzzer")
    "CMSmap" = @("Web", "CMS vulnerability scanner")
    "XSStrike" = @("Web", "Advanced XSS detection suite")
    "XSSer" = @("Web", "Automatic XSS testing tool")
    "SQLNinja" = @("Web", "SQL Server injection tool")
    "Reaver" = @("Wireless", "WPS PIN attack tool")
    "Bully" = @("Wireless", "WPS PIN attack tool")
    "Wifite" = @("Wireless", "Automated wireless attack tool")
    "Fluxion" = @("Wireless", "WPA/WPA2 security testing tool")
    "Airgeddon" = @("Wireless", "Wireless security testing toolkit")
    "Kismet" = @("Wireless", "Wireless network detector and sniffer")
}

# ========== TOOL EXECUTION FUNCTIONS ==========
function Invoke-NmapScan {
    param([string]$Target, [string]$Options = "-sS -sV")
    if (!(Test-ToolInstallation -ToolName "Nmap")) {
        Write-OutputToGUI "‚ùå Nmap not installed. Use Tool Manager first." "Red"
        return
    }
    Write-OutputToGUI "üîç Running Nmap scan: nmap $Options $Target" "Cyan"
    try {
        $result = & nmap $Options $Target 2>&1
        Write-OutputToGUI "‚úÖ Nmap scan completed" "Green"
        Write-OutputToGUI "üìã Results:`n$result" "White"
        $Script:ScanResults += @{Tool="Nmap"; Target=$Target; Results=$result; Timestamp=(Get-Date)}
    } catch {
        Write-OutputToGUI "‚ùå Nmap scan failed: $($_.Exception.Message)" "Red"
    }
}

function Invoke-SqlmapScan {
    param([string]$Target, [string]$Options = "")
    if (!(Test-ToolInstallation -ToolName "Sqlmap")) {
        Write-OutputToGUI "‚ùå Sqlmap not installed. Use Tool Manager first." "Red"
        return
    }
    Write-OutputToGUI "üéØ Running Sqlmap scan: sqlmap -u $Target $Options" "Cyan"
    try {
        $result = & sqlmap -u $Target $Options --batch 2>&1
        Write-OutputToGUI "‚úÖ Sqlmap scan completed" "Green"
        Write-OutputToGUI "üìã Results:`n$result" "White"
        $Script:WebAppFindings += @{Tool="Sqlmap"; Target=$Target; Results=$result; Timestamp=(Get-Date)}
    } catch {
        Write-OutputToGUI "‚ùå Sqlmap scan failed: $($_.Exception.Message)" "Red"
    }
}

function Invoke-HydraAttack {
    param([string]$Target, [string]$Service, [string]$UserList, [string]$PasswordList, [string]$Options = "")
    if (!(Test-ToolInstallation -ToolName "Hydra")) {
        Write-OutputToGUI "‚ùå Hydra not installed. Use Tool Manager first." "Red"
        return
    }
    Write-OutputToGUI "üîë Running Hydra attack on $Service://$Target" "Cyan"
    try {
        $result = & hydra -L $UserList -P $PasswordList $Service://$Target $Options 2>&1
        Write-OutputToGUI "‚úÖ Hydra attack completed" "Green"
        Write-OutputToGUI "üìã Results:`n$result" "White"
        $Script:CrackedHashes += @{Tool="Hydra"; Target=$Target; Service=$Service; Results=$result; Timestamp=(Get-Date)}
    } catch {
        Write-OutputToGUI "‚ùå Hydra attack failed: $($_.Exception.Message)" "Red"
    }
}

function Invoke-MetasploitModule {
    param([string]$Module, [string]$Options = "")
    if (!(Test-ToolInstallation -ToolName "Metasploit")) {
        Write-OutputToGUI "‚ùå Metasploit not installed. Use Tool Manager first." "Red"
        return
    }
    Write-OutputToGUI "üí• Launching Metasploit module: $Module" "Cyan"
    try {
        $msfCommand = @"
use $Module
set RHOSTS $Script:CurrentTarget
$Options
run
"@
        $tempFile = [System.IO.Path]::GetTempFileName()
        $msfCommand | Out-File -FilePath $tempFile
        $result = & msfconsole -r $tempFile 2>&1
        Remove-Item $tempFile
        Write-OutputToGUI "‚úÖ Metasploit module executed" "Green"
        $Script:ExploitSessions += @{Tool="Metasploit"; Module=$Module; Results=$result; Timestamp=(Get-Date)}
    } catch {
        Write-OutputToGUI "‚ùå Metasploit execution failed: $($_.Exception.Message)" "Red"
    }
}

function Invoke-NiktoScan {
    param([string]$Target, [string]$Options = "")
    if (!(Test-ToolInstallation -ToolName "Nikto")) {
        Write-OutputToGUI "‚ùå Nikto not installed. Use Tool Manager first." "Red"
        return
    }
    Write-OutputToGUI "üåê Running Nikto web scan: nikto -h $Target $Options" "Cyan"
    try {
        $result = & nikto -h $Target $Options 2>&1
        Write-OutputToGUI "‚úÖ Nikto scan completed" "Green"
        Write-OutputToGUI "üìã Results:`n$result" "White"
        $Script:WebAppFindings += @{Tool="Nikto"; Target=$Target; Results=$result; Timestamp=(Get-Date)}
    } catch {
        Write-OutputToGUI "‚ùå Nikto scan failed: $($_.Exception.Message)" "Red"
    }
}

function Invoke-WirelessScan {
    if (!(Test-ToolInstallation -ToolName "Aircrack-ng")) {
        Write-OutputToGUI "‚ùå Aircrack-ng not installed. Use Tool Manager first." "Red"
        return
    }
    Write-OutputToGUI "üì° Starting wireless network scan..." "Cyan"
    try {
        $interfaces = & airmon-ng 2>&1
        Write-OutputToGUI "üì° Available interfaces:`n$interfaces" "White"
        Write-OutputToGUI "üì° Putting interface in monitor mode..." "Yellow"
        & airmon-ng start wlan0 2>&1 | Out-Null
        $scanResult = & airodump-ng wlan0mon 2>&1
        Write-OutputToGUI "‚úÖ Wireless scan completed" "Green"
        Write-OutputToGUI "üìã Networks found:`n$scanResult" "White"
        $Script:WirelessNetworks += @{Tool="Aircrack-ng"; Results=$scanResult; Timestamp=(Get-Date)}
    } catch {
        Write-OutputToGUI "‚ùå Wireless scan failed: $($_.Exception.Message)" "Red"
    }
}

function Invoke-JohnCrack {
    param([string]$HashFile, [string]$Wordlist = "")
    if (!(Test-ToolInstallation -ToolName "John")) {
        Write-OutputToGUI "‚ùå John the Ripper not installed. Use Tool Manager first." "Red"
        return
    }
    Write-OutputToGUI "üîì Running John the Ripper on $HashFile" "Cyan"
    try {
        if ($Wordlist -ne "") {
            $result = & john --wordlist=$Wordlist $HashFile 2>&1
        } else {
            $result = & john $HashFile 2>&1
        }
        Write-OutputToGUI "‚úÖ John cracking completed" "Green"
        $cracked = & john --show $HashFile 2>&1
        Write-OutputToGUI "üìã Cracked hashes:`n$cracked" "White"
        $Script:CrackedHashes += @{Tool="John"; HashFile=$HashFile; Results=$cracked; Timestamp=(Get-Date)}
    } catch {
        Write-OutputToGUI "‚ùå John cracking failed: $($_.Exception.Message)" "Red"
    }
}

function Invoke-GobusterScan {
    param([string]$Target, [string]$Wordlist, [string]$Mode = "dir")
    if (!(Test-ToolInstallation -ToolName "GoBuster")) {
        Write-OutputToGUI "‚ùå GoBuster not installed. Use Tool Manager first." "Red"
        return
    }
    Write-OutputToGUI "üîç Running GoBuster $Mode scan on $Target" "Cyan"
    try {
        if ($Mode -eq "dir") {
            $result = & gobuster dir -u $Target -w $Wordlist 2>&1
        } elseif ($Mode -eq "dns") {
            $result = & gobuster dns -d $Target -w $Wordlist 2>&1
        }
        Write-OutputToGUI "‚úÖ GoBuster scan completed" "Green"
        Write-OutputToGUI "üìã Results:`n$result" "White"
        $Script:WebAppFindings += @{Tool="GoBuster"; Target=$Target; Mode=$Mode; Results=$result; Timestamp=(Get-Date)}
    } catch {
        Write-OutputToGUI "‚ùå GoBuster scan failed: $($_.Exception.Message)" "Red"
    }
}

# ========== GUI MANAGEMENT FUNCTIONS ==========
function Write-OutputToGUI {
    param([string]$Message, [string]$Color = "White")
    
    $colorMap = @{
        "Red" = [System.Drawing.Color]::LightCoral
        "Green" = [System.Drawing.Color]::LightGreen
        "Yellow" = [System.Drawing.Color]::LightYellow
        "Cyan" = [System.Drawing.Color]::Cyan
        "White" = [System.Drawing.Color]::White
    }
    
    if ($Script:OutputTextBox -ne $null) {
        $Script:OutputTextBox.SelectionColor = $colorMap[$Color]
        $Script:OutputTextBox.AppendText("$Message`r`n")
        $Script:OutputTextBox.ScrollToCaret()
    } else {
        Write-Host $Message -ForegroundColor $Color
    }
}

function Test-AdminPrivileges {
    return ([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]"Administrator")
}

function Test-ToolInstallation {
    param([string]$ToolName)
    
    $toolPaths = @{
        "Nmap" = @("nmap", "nmap.exe")
        "Wireshark" = @("wireshark", "tshark")
        "Python" = @("python", "python3")
        "Git" = @("git")
        "Metasploit" = @("msfconsole", "msfvenom")
        "Burp Suite" = @("burpsuite")
        "John" = @("john")
        "Hashcat" = @("hashcat")
        "Sqlmap" = @("sqlmap")
        "Aircrack-ng" = @("aircrack-ng")
        "Hydra" = @("hydra")
        "Go" = @("go")
        "Nuclei" = @("nuclei")
        "Subfinder" = @("subfinder")
        "Amass" = @("amass")
        "Masscan" = @("masscan")
        "Nikto" = @("nikto")
        "GoBuster" = @("gobuster")
        "Ruby" = @("ruby")
        "Node.js" = @("node")
        "7zip" = @("7z")
        "Notepad++" = @("notepad++")
        "Putty" = @("putty")
        "WinSCP" = @("winscp")
    }
    
    if ($toolPaths.ContainsKey($ToolName)) {
        foreach ($cmd in $toolPaths[$ToolName]) {
            if (Get-Command $cmd -ErrorAction SilentlyContinue) {
                $Script:InstallStatus[$ToolName] = $true
                return $true
            }
        }
    }
    
    # Check common installation directories
    $commonPaths = @(
        "$env:ProgramFiles",
        "$env:ProgramFiles(x86)", 
        "$env:LOCALAPPDATA\Programs",
        "C:\Tools",
        $Script:ToolsDir,
        $Script:BinDir
    )
    
    foreach ($path in $commonPaths) {
        if (Test-Path "$path\*$ToolName*" -ErrorAction SilentlyContinue) {
            $Script:InstallStatus[$ToolName] = $true
            return $true
        }
    }
    
    $Script:InstallStatus[$ToolName] = $false
    return $false
}

function Install-SpecificTool {
    param([string]$ToolName)
    
    Write-OutputToGUI "üì¶ INSTALLING TOOL: $ToolName" "Cyan"
    
    $chocoPackages = @{
        "Nmap" = "nmap"
        "Wireshark" = "wireshark"
        "Python" = "python"
        "Git" = "git"
        "Metasploit" = "metasploit-framework"
        "Burp Suite" = "burp-suite-free"
        "John" = "john"
        "Hashcat" = "hashcat"
        "Sqlmap" = "sqlmap"
        "Aircrack-ng" = "aircrack-ng"
        "Hydra" = "hydra"
        "Nikto" = "nikto"
        "GoBuster" = "gobuster"
        "Dirb" = "dirb"
        "Nessus" = "nessus"
        "Nuclei" = "nuclei"
        "Subfinder" = "subfinder"
        "Masscan" = "masscan"
        "Recon-ng" = "recon-ng"
        "TheHarvester" = "theharvester"
        "WPScan" = "wpscan"
        "AngryIPScanner" = "angryipscanner"
        "Netcat" = "netcat"
        "Tcpdump" = "tcpdump"
        "Ettercap" = "ettercap"
        "Zenmap" = "zenmap"
        "ZAP" = "zaproxy"
        "Fiddler" = "fiddler"
        "Postman" = "postman"
        "SoapUI" = "soapui"
        "Ophcrack" = "ophcrack"
        "Cain" = "cain"
        "Ruby" = "ruby"
        "Node.js" = "nodejs"
        "VSCode" = "vscode"
        "Golang" = "golang"
        "CMake" = "cmake"
        "Mingw" = "mingw"
        "Vim" = "vim"
        "SublimeText" = "sublimetext3"
        "VisualStudioBuildTools" = "visualstudio2022buildtools"
        "7zip" = "7zip"
        "Notepad++" = "notepadplusplus"
        "Putty" = "putty"
        "WinSCP" = "winscp"
        "OpenVPN" = "openvpn"
        "ProxyChains" = "proxychains"
        "Tor" = "tor-browser"
        "mRemoteNG" = "mremoteng"
        "RDM" = "rdm"
        "HexEditor" = "hexeditor"
        "Curl" = "curl"
        "Wget" = "wget"
        "Jq" = "jq"
        "Grep" = "grep"
        "Sed" = "sed"
        "Awk" = "awk"
        "Yara" = "yara"
        "Sysinternals" = "sysinternals"
        "Autopsy" = "autopsy"
        "Ghidra" = "ghidra"
        "x64dbg" = "x64dbg"
        "ProcessHacker" = "processhacker"
        "PEStudio" = "pestudio"
        "Volatility" = "volatility"
        "dnSpy" = "dnspy"
        "IDA" = "ida-free"
        "WinDbg" = "windbg"
        "BinText" = "bintext"
        "MySQL" = "mysql"
        "MySQLWorkbench" = "mysql.workbench"
        "PostgreSQL" = "postgresql"
        "MongoDB" = "mongodb"
        "SQLite" = "sqlite"
    }
    
    if ($chocoPackages.ContainsKey($ToolName)) {
        $packageName = $chocoPackages[$ToolName]
        try {
            Write-OutputToGUI "üì• Installing $ToolName via Chocolatey..." "Yellow"
            $process = Start-Process -FilePath "choco" -ArgumentList "install", $packageName, "-y", "--force", "--ignore-checksums" -Wait -PassThru -NoNewWindow
            if ($process.ExitCode -eq 0) {
                Write-OutputToGUI "‚úÖ $ToolName installed successfully" "Green"
                $Script:InstallStatus[$ToolName] = $true
            } else {
                Write-OutputToGUI "‚ùå Failed to install $ToolName" "Red"
            }
        } catch {
            Write-OutputToGUI "‚ùå Error installing $ToolName : $($_.Exception.Message)" "Red"
        }
    } else {
        Write-OutputToGUI "‚ö†Ô∏è No Chocolatey package found for $ToolName - manual installation required" "Yellow"
    }
}

function Show-ManualScanner {
    $scannerForm = New-Object System.Windows.Forms.Form
    $scannerForm.Text = "üîç MANUAL SCANNER - TOOL LAUNCHER"
    $scannerForm.Size = New-Object System.Drawing.Size(800, 600)
    $scannerForm.StartPosition = "CenterScreen"
    $scannerForm.BackColor = [System.Drawing.Color]::FromArgb(45, 45, 48)
    $scannerForm.ForeColor = [System.Drawing.Color]::White

    $lblTitle = New-Object System.Windows.Forms.Label
    $lblTitle.Text = "MANUAL TOOL SCANNER - LAUNCH SECURITY TOOLS"
    $lblTitle.Font = New-Object System.Drawing.Font("Segoe UI", 14, [System.Drawing.FontStyle]::Bold)
    $lblTitle.ForeColor = [System.Drawing.Color]::Cyan
    $lblTitle.Size = New-Object System.Drawing.Size(600, 40)
    $lblTitle.Location = New-Object System.Drawing.Point(100, 20)
    $lblTitle.TextAlign = [System.Drawing.ContentAlignment]::MiddleCenter
    $scannerForm.Controls.Add($lblTitle)

    # Tool Selection
    $lblTool = New-Object System.Windows.Forms.Label
    $lblTool.Text = "Select Tool:"
    $lblTool.Location = New-Object System.Drawing.Point(50, 80)
    $lblTool.Size = New-Object System.Drawing.Size(100, 20)
    $scannerForm.Controls.Add($lblTool)

    $comboTools = New-Object System.Windows.Forms.ComboBox
    $comboTools.Location = New-Object System.Drawing.Point(160, 80)
    $comboTools.Size = New-Object System.Drawing.Size(200, 25)
    $comboTools.Items.AddRange(@("Nmap", "Sqlmap", "Nikto", "GoBuster", "Hydra", "John", "Metasploit", "Aircrack-ng"))
    $comboTools.SelectedIndex = 0
    $scannerForm.Controls.Add($comboTools)

    # Target Input
    $lblTarget = New-Object System.Windows.Forms.Label
    $lblTarget.Text = "Target:"
    $lblTarget.Location = New-Object System.Drawing.Point(50, 120)
    $lblTarget.Size = New-Object System.Drawing.Size(100, 20)
    $scannerForm.Controls.Add($lblTarget)

    $txtTarget = New-Object System.Windows.Forms.TextBox
    $txtTarget.Text = $Script:CurrentTarget
    $txtTarget.Location = New-Object System.Drawing.Point(160, 120)
    $txtTarget.Size = New-Object System.Drawing.Size(400, 25)
    $scannerForm.Controls.Add($txtTarget)

    # Options Input
    $lblOptions = New-Object System.Windows.Forms.Label
    $lblOptions.Text = "Options:"
    $lblOptions.Location = New-Object System.Drawing.Point(50, 160)
    $lblOptions.Size = New-Object System.Drawing.Size(100, 20)
    $scannerForm.Controls.Add($lblOptions)

    $txtOptions = New-Object System.Windows.Forms.TextBox
    $txtOptions.Location = New-Object System.Drawing.Point(160, 160)
    $txtOptions.Size = New-Object System.Drawing.Size(400, 25)
    $txtOptions.Text = "-sS -sV -O"
    $scannerForm.Controls.Add($txtOptions)

    # Execute Button
    $btnExecute = New-Object System.Windows.Forms.Button
    $btnExecute.Text = "üöÄ EXECUTE TOOL"
    $btnExecute.Location = New-Object System.Drawing.Point(300, 200)
    $btnExecute.Size = New-Object System.Drawing.Size(200, 40)
    $btnExecute.BackColor = [System.Drawing.Color]::FromArgb(0, 120, 215)
    $btnExecute.ForeColor = [System.Drawing.Color]::White
    $btnExecute.FlatStyle = [System.Windows.Forms.FlatStyle]::Flat
    $btnExecute.Add_Click({
        $selectedTool = $comboTools.SelectedItem.ToString()
        $target = $txtTarget.Text
        $options = $txtOptions.Text
        
        if ([string]::IsNullOrWhiteSpace($target)) {
            [System.Windows.Forms.MessageBox]::Show("Please enter a target.", "Target Required", "OK", "Warning")
            return
        }

        switch ($selectedTool) {
            "Nmap" { Invoke-NmapScan -Target $target -Options $options }
            "Sqlmap" { Invoke-SqlmapScan -Target $target -Options $options }
            "Nikto" { Invoke-NiktoScan -Target $target -Options $options }
            "GoBuster" { Invoke-GobusterScan -Target $target -Wordlist "$Script:ToolsDir\Wordlists\SecLists\Discovery\Web-Content\common.txt" }
            "Hydra" { Invoke-HydraAttack -Target $target -Service "ssh" -UserList "$Script:ToolsDir\Wordlists\SecLists\Usernames\top-usernames-shortlist.txt" -PasswordList "$Script:ToolsDir\Wordlists\rockyou.txt" }
            "John" { Invoke-JohnCrack -HashFile "$Script:ToolsDir\hashes.txt" -Wordlist "$Script:ToolsDir\Wordlists\rockyou.txt" }
            "Metasploit" { Invoke-MetasploitModule -Module "exploit/multi/handler" -Options $options }
            "Aircrack-ng" { Invoke-WirelessScan }
        }
    })
    $scannerForm.Controls.Add($btnExecute)

    # Quick Actions
    $lblQuick = New-Object System.Windows.Forms.Label
    $lblQuick.Text = "Quick Actions:"
    $lblQuick.Font = New-Object System.Drawing.Font("Segoe UI", 10, [System.Drawing.FontStyle]::Bold)
    $lblQuick.Location = New-Object System.Drawing.Point(50, 260)
    $lblQuick.Size = New-Object System.Drawing.Size(200, 20)
    $scannerForm.Controls.Add($lblQuick)

    $quickButtons = @(
        @{Text="üîç Quick Nmap"; Tool="Nmap"; Options="-sS -sV -A"; Y=300},
        @{Text="üåê Web Scan"; Tool="Nikto"; Options="-h $Script:CurrentTarget"; Y=350},
        @{Text="üóÇÔ∏è Directory Brute"; Tool="GoBuster"; Options="dir"; Y=400},
        @{Text="üîë SSH Brute"; Tool="Hydra"; Options="ssh"; Y=450}
    )

    foreach ($btn in $quickButtons) {
        $quickBtn = New-Object System.Windows.Forms.Button
        $quickBtn.Text = $btn.Text
        $quickBtn.Location = New-Object System.Drawing.Point(50, $btn.Y)
        $quickBtn.Size = New-Object System.Drawing.Size(200, 35)
        $quickBtn.BackColor = [System.Drawing.Color]::FromArgb(0, 100, 180)
        $quickBtn.ForeColor = [System.Drawing.Color]::White
        $quickBtn.FlatStyle = [System.Windows.Forms.FlatStyle]::Flat
        $quickBtn.Add_Click({
            $comboTools.SelectedItem = $btn.Tool
            $txtOptions.Text = $btn.Options
            $btnExecute.PerformClick()
        })
        $scannerForm.Controls.Add($quickBtn)
    }

    $scannerForm.ShowDialog() | Out-Null
}

function Show-SetupWizard {
    $setupForm = New-Object System.Windows.Forms.Form
    $setupForm.Text = "üõ°Ô∏è PENETRATION TESTING FRAMEWORK SETUP"
    $setupForm.Size = New-Object System.Drawing.Size(600, 400)
    $setupForm.StartPosition = "CenterScreen"
    $setupForm.BackColor = [System.Drawing.Color]::FromArgb(45, 45, 48)
    $setupForm.ForeColor = [System.Drawing.Color]::White

    $lblTitle = New-Object System.Windows.Forms.Label
    $lblTitle.Text = "ULTIMATE PENETRATION TESTING FRAMEWORK SETUP"
    $lblTitle.Font = New-Object System.Drawing.Font("Segoe UI", 14, [System.Drawing.FontStyle]::Bold)
    $lblTitle.ForeColor = [System.Drawing.Color]::Cyan
    $lblTitle.Size = New-Object System.Drawing.Size(500, 40)
    $lblTitle.Location = New-Object System.Drawing.Point(50, 20)
    $lblTitle.TextAlign = [System.Drawing.ContentAlignment]::MiddleCenter
    $setupForm.Controls.Add($lblTitle)

    $lblInfo = New-Object System.Windows.Forms.Label
    $lblInfo.Text = "This framework provides manual control over 150+ security tools.`n`nYou choose what to install and when to use it."
    $lblInfo.Size = New-Object System.Drawing.Size(500, 60)
    $lblInfo.Location = New-Object System.Drawing.Point(50, 70)
    $lblInfo.TextAlign = [System.Drawing.ContentAlignment]::MiddleCenter
    $setupForm.Controls.Add($lblInfo)

    $btnContinue = New-Object System.Windows.Forms.Button
    $btnContinue.Text = "üöÄ CONTINUE SETUP"
    $btnContinue.Size = New-Object System.Drawing.Size(200, 40)
    $btnContinue.Location = New-Object System.Drawing.Point(200, 150)
    $btnContinue.BackColor = [System.Drawing.Color]::FromArgb(0, 120, 215)
    $btnContinue.ForeColor = [System.Drawing.Color]::White
    $btnContinue.FlatStyle = [System.Windows.Forms.FlatStyle]::Flat
    $btnContinue.DialogResult = [System.Windows.Forms.DialogResult]::OK
    $setupForm.Controls.Add($btnContinue)

    $btnCancel = New-Object System.Windows.Forms.Button
    $btnCancel.Text = "Cancel"
    $btnCancel.Size = New-Object System.Drawing.Size(200, 40)
    $btnCancel.Location = New-Object System.Drawing.Point(200, 200)
    $btnCancel.BackColor = [System.Drawing.Color]::FromArgb(100, 100, 100)
    $btnCancel.ForeColor = [System.Drawing.Color]::White
    $btnCancel.FlatStyle = [System.Windows.Forms.FlatStyle]::Flat
    $btnCancel.DialogResult = [System.Windows.Forms.DialogResult]::Cancel
    $setupForm.Controls.Add($btnCancel)

    return $setupForm.ShowDialog() -eq [System.Windows.Forms.DialogResult]::OK
}

function Show-ToolManager {
    $toolsForm = New-Object System.Windows.Forms.Form
    $toolsForm.Text = "üîß COMPLETE TOOL MANAGER"
    $toolsForm.Size = New-Object System.Drawing.Size(1000, 700)
    $toolsForm.StartPosition = "CenterScreen"
    $toolsForm.BackColor = [System.Drawing.Color]::FromArgb(45, 45, 48)
    $toolsForm.ForeColor = [System.Drawing.Color]::White

    $lblTitle = New-Object System.Windows.Forms.Label
    $lblTitle.Text = "COMPLETE PENETRATION TESTING TOOL ARSENAL"
    $lblTitle.Font = New-Object System.Drawing.Font("Segoe UI", 14, [System.Drawing.FontStyle]::Bold)
    $lblTitle.ForeColor = [System.Drawing.Color]::Cyan
    $lblTitle.Size = New-Object System.Drawing.Size(800, 40)
    $lblTitle.Location = New-Object System.Drawing.Point(100, 20)
    $lblTitle.TextAlign = [System.Drawing.ContentAlignment]::MiddleCenter
    $toolsForm.Controls.Add($lblTitle)

    # Tool Categories
    $lblCategory = New-Object System.Windows.Forms.Label
    $lblCategory.Text = "Tool Category:"
    $lblCategory.Location = New-Object System.Drawing.Point(50, 80)
    $lblCategory.Size = New-Object System.Drawing.Size(100, 20)
    $toolsForm.Controls.Add($lblCategory)

    $comboCategory = New-Object System.Windows.Forms.ComboBox
    $comboCategory.Location = New-Object System.Drawing.Point(160, 80)
    $comboCategory.Size = New-Object System.Drawing.Size(200, 25)
    $comboCategory.Items.AddRange(@("All Tools", "Network", "Web", "Cracker", "Wireless", "Exploitation", "Vulnerability", "Recon", "Forensics", "Reverse", "Database", "Utility", "Development", "Language", "PostExploit", "Social"))
    $comboCategory.SelectedIndex = 0
    $comboCategory.Add_SelectedIndexChanged({
        Update-ToolList -Category $comboCategory.SelectedItem
    })
    $toolsForm.Controls.Add($comboCategory)

    # Search Box
    $lblSearch = New-Object System.Windows.Forms.Label
    $lblSearch.Text = "Search:"
    $lblSearch.Location = New-Object System.Drawing.Point(400, 80)
    $lblSearch.Size = New-Object System.Drawing.Size(50, 20)
    $toolsForm.Controls.Add($lblSearch)

    $txtSearch = New-Object System.Windows.Forms.TextBox
    $txtSearch.Location = New-Object System.Drawing.Point(460, 80)
    $txtSearch.Size = New-Object System.Drawing.Size(200, 25)
    $txtSearch.Add_TextChanged({
        Update-ToolList -Category $comboCategory.SelectedItem -Search $txtSearch.Text
    })
    $toolsForm.Controls.Add($txtSearch)

    # Tool List View
    $listTools = New-Object System.Windows.Forms.ListView
    $listTools.Location = New-Object System.Drawing.Point(50, 120)
    $listTools.Size = New-Object System.Drawing.Size(900, 400)
    $listTools.View = [System.Windows.Forms.View]::Details
    $listTools.FullRowSelect = $true
    $listTools.GridLines = $true
    $listTools.MultiSelect = $true
    $listTools.BackColor = [System.Drawing.Color]::FromArgb(30, 30, 30)
    $listTools.ForeColor = [System.Drawing.Color]::White
    $listTools.Columns.Add("Tool Name", 200) | Out-Null
    $listTools.Columns.Add("Status", 100) | Out-Null
    $listTools.Columns.Add("Category", 120) | Out-Null
    $listTools.Columns.Add("Description", 480) | Out-Null
    $toolsForm.Controls.Add($listTools)

    # Progress Bar
    $progressBar = New-Object System.Windows.Forms.ProgressBar
    $progressBar.Location = New-Object System.Drawing.Point(50, 530)
    $progressBar.Size = New-Object System.Drawing.Size(900, 20)
    $progressBar.Visible = $false
    $toolsForm.Controls.Add($progressBar)

    # Status Label
    $lblStatus = New-Object System.Windows.Forms.Label
    $lblStatus.Location = New-Object System.Drawing.Point(50, 555)
    $lblStatus.Size = New-Object System.Drawing.Size(900, 20)
    $lblStatus.TextAlign = [System.Drawing.ContentAlignment]::MiddleLeft
    $toolsForm.Controls.Add($lblStatus)

    # Action Buttons
    $btnCheckAll = New-Object System.Windows.Forms.Button
    $btnCheckAll.Text = "üîç CHECK ALL TOOLS"
    $btnCheckAll.Location = New-Object System.Drawing.Point(50, 580)
    $btnCheckAll.Size = New-Object System.Drawing.Size(140, 40)
    $btnCheckAll.BackColor = [System.Drawing.Color]::FromArgb(0, 120, 215)
    $btnCheckAll.ForeColor = [System.Drawing.Color]::White
    $btnCheckAll.FlatStyle = [System.Windows.Forms.FlatStyle]::Flat
    $btnCheckAll.Add_Click({
        Check-AllTools
        Update-ToolList -Category $comboCategory.SelectedItem -Search $txtSearch.Text
    })
    $toolsForm.Controls.Add($btnCheckAll)

    $btnInstallSelected = New-Object System.Windows.Forms.Button
    $btnInstallSelected.Text = "üì¶ INSTALL SELECTED"
    $btnInstallSelected.Location = New-Object System.Drawing.Point(200, 580)
    $btnInstallSelected.Size = New-Object System.Drawing.Size(140, 40)
    $btnInstallSelected.BackColor = [System.Drawing.Color]::FromArgb(0, 150, 0)
    $btnInstallSelected.ForeColor = [System.Drawing.Color]::White
    $btnInstallSelected.FlatStyle = [System.Windows.Forms.FlatStyle]::Flat
    $btnInstallSelected.Add_Click({
        if ($listTools.SelectedItems.Count -eq 0) {
            [System.Windows.Forms.MessageBox]::Show("Please select tools to install.", "Selection Required", "OK", "Information")
            return
        }
        
        $progressBar.Visible = $true
        $progressBar.Maximum = $listTools.SelectedItems.Count
        $progressBar.Value = 0
        
        foreach ($item in $listTools.SelectedItems) {
            $toolName = $item.Text
            $lblStatus.Text = "Installing: $toolName"
            $progressBar.Value++
            [System.Windows.Forms.Application]::DoEvents()
            
            Install-SpecificTool -ToolName $toolName
        }
        
        $progressBar.Visible = $false
        $lblStatus.Text = "Installation completed"
        Update-ToolList -Category $comboCategory.SelectedItem -Search $txtSearch.Text
    })
    $toolsForm.Controls.Add($btnInstallSelected)

    $btnClose = New-Object System.Windows.Forms.Button
    $btnClose.Text = "CLOSE"
    $btnClose.Location = New-Object System.Drawing.Point(810, 580)
    $btnClose.Size = New-Object System.Drawing.Size(140, 40)
    $btnClose.BackColor = [System.Drawing.Color]::FromArgb(100, 100, 100)
    $btnClose.ForeColor = [System.Drawing.Color]::White
    $btnClose.FlatStyle = [System.Windows.Forms.FlatStyle]::Flat
    $btnClose.Add_Click({ $toolsForm.Close() })
    $toolsForm.Controls.Add($btnClose)

    function Update-ToolList {
        param($Category, $Search = "")
        
        $listTools.Items.Clear()
        $toolsToShow = $Script:AllTools.Keys | Sort-Object
        
        if ($Category -ne "All Tools") {
            $toolsToShow = $toolsToShow | Where-Object { $Script:AllTools[$_][0] -eq $Category }
        }
        
        if (![string]::IsNullOrWhiteSpace($Search)) {
            $toolsToShow = $toolsToShow | Where-Object { $_ -match $Search }
        }
        
        foreach ($tool in $toolsToShow) {
            $status = if ($Script:InstallStatus[$tool]) { "‚úÖ INSTALLED" } else { "‚ùå MISSING" }
            $categoryInfo = $Script:AllTools[$tool]
            $item = New-Object System.Windows.Forms.ListViewItem($tool)
            $item.SubItems.Add($status) | Out-Null
            $item.SubItems.Add($categoryInfo[0]) | Out-Null
            $item.SubItems.Add($categoryInfo[1]) | Out-Null
            
            if ($Script:InstallStatus[$tool]) {
                $item.BackColor = [System.Drawing.Color]::FromArgb(0, 50, 0)
            } else {
                $item.BackColor = [System.Drawing.Color]::FromArgb(50, 0, 0)
            }
            
            $listTools.Items.Add($item) | Out-Null
        }
        
        $lblStatus.Text = "Showing $($listTools.Items.Count) tools"
    }

    function Check-AllTools {
        $progressBar.Visible = $true
        $progressBar.Maximum = $Script:AllTools.Count
        $progressBar.Value = 0
        
        foreach ($tool in $Script:AllTools.Keys) {
            $lblStatus.Text = "Checking: $tool"
            $progressBar.Value++
            [System.Windows.Forms.Application]::DoEvents()
            
            Test-ToolInstallation -ToolName $tool
        }
        
        $progressBar.Visible = $false
        $lblStatus.Text = "Tool check completed"
    }

    # Initial load
    Check-AllTools
    Update-ToolList -Category "All Tools"
    
    $toolsForm.ShowDialog() | Out-Null
}

function Show-TargetSelection {
    $targetForm = New-Object System.Windows.Forms.Form
    $targetForm.Text = "üéØ SELECT TARGET"
    $targetForm.Size = New-Object System.Drawing.Size(500, 300)
    $targetForm.StartPosition = "CenterScreen"
    $targetForm.BackColor = [System.Drawing.Color]::FromArgb(45, 45, 48)
    $targetForm.ForeColor = [System.Drawing.Color]::White

    $lblTitle = New-Object System.Windows.Forms.Label
    $lblTitle.Text = "SET TARGET FOR PENETRATION TESTING"
    $lblTitle.Font = New-Object System.Drawing.Font("Segoe UI", 12, [System.Drawing.FontStyle]::Bold)
    $lblTitle.ForeColor = [System.Drawing.Color]::Cyan
    $lblTitle.Size = New-Object System.Drawing.Size(400, 30)
    $lblTitle.Location = New-Object System.Drawing.Point(50, 20)
    $lblTitle.TextAlign = [System.Drawing.ContentAlignment]::MiddleCenter
    $targetForm.Controls.Add($lblTitle)

    $lblTarget = New-Object System.Windows.Forms.Label
    $lblTarget.Text = "Target (IP, URL, or Domain):"
    $lblTarget.Location = New-Object System.Drawing.Point(50, 70)
    $lblTarget.Size = New-Object System.Drawing.Size(150, 20)
    $targetForm.Controls.Add($lblTarget)

    $txtTarget = New-Object System.Windows.Forms.TextBox
    $txtTarget.Text = $Script:CurrentTarget
    $txtTarget.Location = New-Object System.Drawing.Point(200, 70)
    $txtTarget.Size = New-Object System.Drawing.Size(200, 25)
    $targetForm.Controls.Add($txtTarget)

    $btnSet = New-Object System.Windows.Forms.Button
    $btnSet.Text = "üéØ SET TARGET"
    $btnSet.Location = New-Object System.Drawing.Point(150, 120)
    $btnSet.Size = New-Object System.Drawing.Size(200, 40)
    $btnSet.BackColor = [System.Drawing.Color]::FromArgb(0, 120, 215)
    $btnSet.ForeColor = [System.Drawing.Color]::White
    $btnSet.FlatStyle = [System.Windows.Forms.FlatStyle]::Flat
    $btnSet.Add_Click({
        $Script:CurrentTarget = $txtTarget.Text
        Write-OutputToGUI "üéØ TARGET SET: $Script:CurrentTarget" "Green"
        $targetForm.Close()
    })
    $targetForm.Controls.Add($btnSet)

    $targetForm.ShowDialog() | Out-Null
}

# ========== MAIN GUI ==========
function Show-MainGUI {
    # Main Form
    $Script:MainForm = New-Object System.Windows.Forms.Form
    $Script:MainForm.Text = "üõ°Ô∏è ULTIMATE PENETRATION TESTING FRAMEWORK - COMPLETE EDITION"
    $Script:MainForm.Size = New-Object System.Drawing.Size(1200, 800)
    $Script:MainForm.StartPosition = "CenterScreen"
    $Script:MainForm.BackColor = [System.Drawing.Color]::FromArgb(45, 45, 48)
    $Script:MainForm.ForeColor = [System.Drawing.Color]::White
    $Script:MainForm.Font = New-Object System.Drawing.Font("Segoe UI", 10)

    # Main Panel
    $mainPanel = New-Object System.Windows.Forms.Panel
    $mainPanel.Size = New-Object System.Drawing.Size(1180, 700)
    $mainPanel.Location = New-Object System.Drawing.Point(10, 10)
    $mainPanel.BackColor = [System.Drawing.Color]::FromArgb(60, 60, 60)
    $Script:MainForm.Controls.Add($mainPanel)

    # Welcome Label
    $lblWelcome = New-Object System.Windows.Forms.Label
    $lblWelcome.Text = "ULTIMATE PENETRATION TESTING FRAMEWORK - COMPLETE EDITION"
    $lblWelcome.Font = New-Object System.Drawing.Font("Segoe UI", 16, [System.Drawing.FontStyle]::Bold)
    $lblWelcome.ForeColor = [System.Drawing.Color]::Cyan
    $lblWelcome.Size = New-Object System.Drawing.Size(800, 40)
    $lblWelcome.Location = New-Object System.Drawing.Point(200, 20)
    $lblWelcome.TextAlign = [System.Drawing.ContentAlignment]::MiddleCenter
    $mainPanel.Controls.Add($lblWelcome)

    # Quick Stats
    $lblStats = New-Object System.Windows.Forms.Label
    $lblStats.Text = "QUICK STATS:"
    $lblStats.Font = New-Object System.Drawing.Font("Segoe UI", 12, [System.Drawing.FontStyle]::Bold)
    $lblStats.Size = New-Object System.Drawing.Size(200, 25)
    $lblStats.Location = New-Object System.Drawing.Point(50, 80)
    $mainPanel.Controls.Add($lblStats)

    $installedCount = ($Script:InstallStatus.Values | Where-Object { $_ -eq $true }).Count
    $totalTools = $Script:AllTools.Count
    
    $lblToolStats = New-Object System.Windows.Forms.Label
    $lblToolStats.Text = "Tools: $installedCount/$totalTools installed"
    $lblToolStats.Location = New-Object System.Drawing.Point(50, 110)
    $lblToolStats.Size = New-Object System.Drawing.Size(300, 20)
    $lblToolStats.ForeColor = if ($installedCount -eq $totalTools) { [System.Drawing.Color]::LightGreen } else { [System.Drawing.Color]::Yellow }
    $mainPanel.Controls.Add($lblToolStats)

    $lblTargetInfo = New-Object System.Windows.Forms.Label
    $lblTargetInfo.Text = "Current Target: $Script:CurrentTarget"
    $lblTargetInfo.Location = New-Object System.Drawing.Point(50, 135)
    $lblTargetInfo.Size = New-Object System.Drawing.Size(400, 20)
    $mainPanel.Controls.Add($lblTargetInfo)

    # Manual Control Buttons
    $buttons = @(
        @{Text="üéØ SELECT TARGET"; Location=@(50,150); Click={Show-TargetSelection}},
        @{Text="üîß TOOL MANAGER"; Location=@(50,200); Click={Show-ToolManager}},
        @{Text="üîç MANUAL SCANNER"; Location=@(50,250); Click={Show-ManualScanner}},
        @{Text="üåê WEB APP TESTER"; Location=@(50,300); Click={Show-ManualScanner}},
        @{Text="üí• EXPLOITATION"; Location=@(50,350); Click={Show-ManualScanner}},
        @{Text="üì° WIRELESS TOOLS"; Location=@(50,400); Click={Show-ManualScanner}},
        @{Text="üîë PASSWORD TOOLS"; Location=@(50,450); Click={Show-ManualScanner}},
        @{Text="üöÄ FULL AUTO INSTALL"; Location=@(320,150); Click={Start-FullInstallation}},
        @{Text="üìä SYSTEM STATUS"; Location=@(320,200); Click={Show-SystemStatus}},
        @{Text="üìÅ OPEN TOOLS DIR"; Location=@(320,250); Click={Invoke-Item $Script:ToolsDir}},
        @{Text="üõ†Ô∏è ADVANCED TOOLS"; Location=@(320,300); Click={Show-AdvancedTools}},
        @{Text="üìã GENERATE REPORT"; Location=@(320,350); Click={Generate-Report}},
        @{Text="‚öôÔ∏è SETTINGS"; Location=@(320,400); Click={Show-Settings}}
    )

    foreach ($btn in $buttons) {
        $button = New-Object System.Windows.Forms.Button
        $button.Text = $btn.Text
        $button.Location = New-Object System.Drawing.Point($btn.Location[0], $btn.Location[1])
        $button.Size = New-Object System.Drawing.Size(250, 40)
        $button.BackColor = [System.Drawing.Color]::FromArgb(0, 120, 215)
        $button.ForeColor = [System.Drawing.Color]::White
        $button.FlatStyle = [System.Windows.Forms.FlatStyle]::Flat
        $button.Add_Click($btn.Click)
        $mainPanel.Controls.Add($button)
    }

    # Output Console
    $outputGroup = New-Object System.Windows.Forms.GroupBox
    $outputGroup.Text = "üìä LIVE OUTPUT & RESULTS"
    $outputGroup.Size = New-Object System.Drawing.Size(1160, 150)
    $outputGroup.Location = New-Object System.Drawing.Point(10, 520)
    $outputGroup.ForeColor = [System.Drawing.Color]::White

    $Script:OutputTextBox = New-Object System.Windows.Forms.RichTextBox
    $Script:OutputTextBox.Location = New-Object System.Drawing.Point(10, 20)
    $Script:OutputTextBox.Size = New-Object System.Drawing.Size(1140, 120)
    $Script:OutputTextBox.BackColor = [System.Drawing.Color]::FromArgb(30, 30, 30)
    $Script:OutputTextBox.ForeColor = [System.Drawing.Color]::White
    $Script:OutputTextBox.Font = New-Object System.Drawing.Font("Consolas", 9)
    $Script:OutputTextBox.ReadOnly = $true
    $outputGroup.Controls.Add($Script:OutputTextBox)

    $mainPanel.Controls.Add($outputGroup)

    # Show the form
    Write-OutputToGUI "üöÄ ULTIMATE PENETRATION TESTING FRAMEWORK INITIALIZED" "Cyan"
    Write-OutputToGUI "‚úÖ COMPLETE ARSENAL LOADED - $totalTools TOOLS AVAILABLE" "Green"
    Write-OutputToGUI "üéØ MANUAL CONTROL MODE - FULL FUNCTIONALITY" "Yellow"
    Write-OutputToGUI "üõ°Ô∏è Admin privileges: $(if (Test-AdminPrivileges) {'Yes'} else {'No'})" "Cyan"
    Write-OutputToGUI "üìÅ Tools Directory: $Script:ToolsDir" "White"

    $Script:MainForm.ShowDialog() | Out-Null
}

# ========== FULL INSTALLATION FUNCTIONS ==========
function Start-FullInstallation {
    $result = [System.Windows.Forms.MessageBox]::Show(
        "This will install ALL 150+ penetration testing tools.`n`nThis may take 30-60 minutes and require several GB of disk space.`n`nContinue?", 
        "Full Installation", 
        [System.Windows.Forms.MessageBoxButtons]::YesNo, 
        [System.Windows.Forms.MessageBoxIcon]::Warning
    )
    
    if ($result -eq [System.Windows.Forms.DialogResult]::Yes) {
        Write-OutputToGUI "üöÄ STARTING FULL AUTOMATED INSTALLATION..." "Cyan"
        # Run the full installation in a background job
        Start-Job -ScriptBlock {
            param($ToolsDir)
            & {
                # Full installation code from the first script would go here
                # This is a simplified version for demonstration
                Write-Host "Starting full installation..." -ForegroundColor Green
                # Actual installation commands would be here
            }
        } -ArgumentList $Script:ToolsDir
    }
}

function Show-SystemStatus {
    $statusForm = New-Object System.Windows.Forms.Form
    $statusForm.Text = "üìä SYSTEM STATUS"
    $statusForm.Size = New-Object System.Drawing.Size(600, 400)
    $statusForm.StartPosition = "CenterScreen"
    $statusForm.BackColor = [System.Drawing.Color]::FromArgb(45, 45, 48)
    $statusForm.ForeColor = [System.Drawing.Color]::White

    $lblTitle = New-Object System.Windows.Forms.Label
    $lblTitle.Text = "SYSTEM STATUS OVERVIEW"
    $lblTitle.Font = New-Object System.Drawing.Font("Segoe UI", 14, [System.Drawing.FontStyle]::Bold)
    $lblTitle.ForeColor = [System.Drawing.Color]::Cyan
    $lblTitle.Size = New-Object System.Drawing.Size(400, 40)
    $lblTitle.Location = New-Object System.Drawing.Point(100, 20)
    $lblTitle.TextAlign = [System.Drawing.ContentAlignment]::MiddleCenter
    $statusForm.Controls.Add($lblTitle)

    $txtStatus = New-Object System.Windows.Forms.TextBox
    $txtStatus.Location = New-Object System.Drawing.Point(50, 80)
    $txtStatus.Size = New-Object System.Drawing.Size(500, 250)
    $txtStatus.Multiline = $true
    $txtStatus.ScrollBars = "Vertical"
    $txtStatus.BackColor = [System.Drawing.Color]::FromArgb(30, 30, 30)
    $txtStatus.ForeColor = [System.Drawing.Color]::White
    $txtStatus.ReadOnly = $true

    $statusInfo = @"
=== SYSTEM STATUS ===
Admin Privileges: $(if (Test-AdminPrivileges) {'Yes'} else {'No'})
Tools Directory: $Script:ToolsDir
Tools Installed: $(($Script:InstallStatus.Values | Where-Object { $_ -eq $true }).Count)/$($Script:AllTools.Count)
Current Target: $Script:CurrentTarget
Scans Performed: $($Script:ScanResults.Count)
Web Findings: $($Script:WebAppFindings.Count)
Cracked Hashes: $($Script:CrackedHashes.Count)

=== RECOMMENDATIONS ===
$(
if ((Test-AdminPrivileges) -eq $false) {
    "‚ö†Ô∏è Run as Administrator for full functionality`n"
}
if ((Test-ToolInstallation -ToolName "Nmap") -eq $false) {
    "‚ö†Ô∏è Install Nmap for network scanning`n"
}
if ((Test-ToolInstallation -ToolName "Python") -eq $false) {
    "‚ö†Ô∏è Install Python for scripting tools`n"
}
if ((Test-ToolInstallation -ToolName "Git") -eq $false) {
    "‚ö†Ô∏è Install Git for tool management`n"
}
)
"@
    $txtStatus.Text = $statusInfo
    $statusForm.Controls.Add($txtStatus)

    $statusForm.ShowDialog() | Out-Null
}

function Show-AdvancedTools {
    Write-OutputToGUI "üõ†Ô∏è Advanced tools menu would open here" "Cyan"
    # Implementation for advanced tools
}

function Generate-Report {
    $report = @"
=== PENETRATION TESTING REPORT ===
Generated: $(Get-Date)
Target: $Script:CurrentTarget
Tools Used: $($Script:ScanResults.Count + $Script:WebAppFindings.Count + $Script:CrackedHashes.Count)

SCAN RESULTS:
$(($Script:ScanResults | ForEach-Object { "  - $($_.Tool) on $($_.Target) at $($_.Timestamp)" }) -join "`n")

WEB FINDINGS:
$(($Script:WebAppFindings | ForEach-Object { "  - $($_.Tool) on $($_.Target)" }) -join "`n")

CRACKED HASHES:
$(($Script:CrackedHashes | ForEach-Object { "  - $($_.Tool): $($_.Results)" }) -join "`n")
"@
    
    $reportPath = "$($Script:UserSettings.DefaultOutputDir)\Report_$(Get-Date -Format 'yyyyMMdd_HHmmss').txt"
    $report | Out-File -FilePath $reportPath -Encoding UTF8
    Write-OutputToGUI "üìã Report generated: $reportPath" "Green"
}

function Show-Settings {
    Write-OutputToGUI "‚öôÔ∏è Settings menu would open here" "Cyan"
    # Implementation for settings
}

# ========== FULL AUTOMATED INSTALLATION ==========
function Install-Chocolatey {
    if (!(Get-Command choco -ErrorAction SilentlyContinue)) {
        Write-OutputToGUI "[+] Installing Chocolatey..." "Green"
        Set-ExecutionPolicy Bypass -Scope Process -Force
        [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072
        iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))
        refreshenv
    } else {
        Write-OutputToGUI "‚úÖ Chocolatey already installed" "Green"
    }
}

function Setup-DirectoryStructure {
    $dirs = @(
        $Script:BinDir,
        "$Script:ToolsDir\NetworkScanning",
        "$Script:ToolsDir\WebApplications", 
        "$Script:ToolsDir\Exploitation",
        "$Script:ToolsDir\PostExploitation",
        "$Script:ToolsDir\PasswordCracking",
        "$Script:ToolsDir\Forensics",
        "$Script:ToolsDir\ReverseEngineering", 
        "$Script:ToolsDir\OSINT",
        "$Script:ToolsDir\Wireless",
        "$Script:ToolsDir\Wordlists",
        "$Script:ToolsDir\Reports",
        "$Script:ToolsDir\Scripts",
        "$Script:ToolsDir\AI-Tools",
        "$Script:ToolsDir\Cloud",
        "$Script:ToolsDir\Config",
        "$Script:ToolsDir\Hardware"
    )
    
    foreach ($dir in $dirs) {
        if (!(Test-Path $dir)) {
            New-Item -ItemType Directory -Path $dir -Force | Out-Null
            Write-OutputToGUI "üìÅ Created directory: $dir" "White"
        }
    }
}

function Install-NetworkTools {
    Write-OutputToGUI "`n[+] PHASE 1: Core Network & Scanning Tools" "Yellow"
    $networkTools = @(
        "nmap", "wireshark", "angryipscanner", "masscan", "netcat", 
        "tcpdump", "ettercap", "aircrack-ng", "zenmap"
    )
    foreach ($tool in $networkTools) { 
        Write-OutputToGUI "Installing $tool..." "Cyan"
        choco install $tool -y --ignore-checksums --force 2>$null 
    }
}

function Install-WebTools {
    Write-OutputToGUI "`n[+] PHASE 2: Web Application Testing" "Yellow"
    $webTools = @(
        "burp-suite-free-edition", "zaproxy", "fiddler", "postman", "soapui"
    )
    foreach ($tool in $webTools) { 
        Write-OutputToGUI "Installing $tool..." "Cyan"
        choco install $tool -y --ignore-checksums --force 2>$null 
    }
}

function Install-PasswordTools {
    Write-OutputToGUI "`n[+] PHASE 3: Password & Hash Cracking" "Yellow"
    $passwordTools = @(
        "hashcat", "john-the-ripper", "hydra", "ophcrack", "cain"
    )
    foreach ($tool in $passwordTools) { 
        Write-OutputToGUI "Installing $tool..." "Cyan"
        choco install $tool -y --ignore-checksums --force 2>$null 
    }
}

function Install-DevelopmentTools {
    Write-OutputToGUI "`n[+] PHASE 4: Development Environment" "Yellow"
    $devTools = @(
        "git", "vscode", "golang", "ruby", "nodejs", "cmake", "mingw", 
        "vim", "sublimetext3", "visualstudio2022buildtools"
    )
    foreach ($tool in $devTools) { 
        Write-OutputToGUI "Installing $tool..." "Cyan"
        choco install $tool -y --ignore-checksums --force 2>$null 
    }
}

function Install-PythonTools {
    Write-OutputToGUI "`n[+] PHASE 5: Python Security Tools" "Yellow"
    Write-OutputToGUI "Upgrading pip..." "Cyan"
    python -m pip install --upgrade pip setuptools wheel --quiet

    $pythonTools = @(
        "impacket", "pwntools", "pymetasploit3", "crackmapexec", "mitm6", "responder", "bloodhound", "ldapdomaindump",
        "sqlmap", "dirsearch", "wfuzz", "xsscrapy", "wafw00f", "commix", "xsstrike",
        "theHarvester", "shodan", "censys", "spiderfoot", "recon-ng", "osrframework", "sherlock-project",
        "scapy", "scapy-http", "python-nmap", "pyshark", "pcapy", "netaddr", "netifaces", "mac-vendor-lookup",
        "pycryptodome", "cryptography", "pyopenssl", "hashid",
        "requests", "beautifulsoup4", "lxml", "selenium", "scrapy", "mechanize", "urllib3",
        "pentest-gpt", "langchain", "openai",
        "social-engineer-toolkit", "gophish",
        "paramiko", "fabric", "ansible", "colorama", "termcolor", "tabulate", "rich", "click",
        "boofuzz", "atheris", "pytbull", "yara-python", "pefile", "python-magic", "pillow", "wapiti3"
    )

    foreach ($tool in $pythonTools) {
        Write-OutputToGUI "Installing $tool..." "Cyan"
        python -m pip install $tool --quiet 2>$null
    }
}

function Install-GoTools {
    Write-OutputToGUI "`n[+] PHASE 6: Go Security Tools" "Yellow"

    $goTools = @(
        "github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest",
        "github.com/projectdiscovery/subfinder/v2/cmd/subfinder@latest",
        "github.com/projectdiscovery/httpx/cmd/httpx@latest",
        "github.com/projectdiscovery/naabu/v2/cmd/naabu@latest",
        "github.com/projectdiscovery/dnsx/cmd/dnsx@latest",
        "github.com/projectdiscovery/katana/cmd/katana@latest",
        "github.com/projectdiscovery/interactsh/cmd/interactsh-client@latest",
        "github.com/projectdiscovery/chaos-client/cmd/chaos@latest",
        "github.com/projectdiscovery/notify/cmd/notify@latest",
        "github.com/projectdiscovery/uncover/cmd/uncover@latest",
        "github.com/projectdiscovery/cloudlist/cmd/cloudlist@latest",
        "github.com/projectdiscovery/asnmap/cmd/asnmap@latest",
        "github.com/ffuf/ffuf/v2@latest",
        "github.com/OJ/gobuster/v3@latest",
        "github.com/tomnomnom/waybackurls@latest",
        "github.com/tomnomnom/httprobe@latest",
        "github.com/tomnomnom/assetfinder@latest",
        "github.com/tomnomnom/meg@latest",
        "github.com/tomnomnom/gf@latest",
        "github.com/tomnomnom/anew@latest",
        "github.com/tomnomnom/unfurl@latest",
        "github.com/tomnomnom/qsreplace@latest",
        "github.com/lc/gau/v2/cmd/gau@latest",
        "github.com/hakluke/hakrawler@latest",
        "github.com/hahwul/dalfox/v2@latest",
        "github.com/jaeles-project/gospider@latest",
        "github.com/KathanP19/Gxss@latest",
        "github.com/lc/subjs@latest",
        "github.com/d3mondev/puredns/v2@latest",
        "github.com/OWASP/Amass/v4/...@latest",
        "github.com/tomnomnom/hacks/anti-burl@latest",
        "github.com/ropnop/kerbrute@latest",
        "github.com/michenriksen/aquatone@latest",
        "github.com/sensepost/gowitness@latest"
    )

    foreach ($tool in $goTools) {
        Write-OutputToGUI "Installing $tool..." "Cyan"
        go install -v $tool 2>$null
    }
}

function Install-Wordlists {
    Write-OutputToGUI "`n[+] PHASE 7: Essential Repositories & Wordlists" "Yellow"

    # SecLists
    if (!(Test-Path "$Script:ToolsDir\Wordlists\SecLists")) {
        Write-OutputToGUI "Cloning SecLists..." "Cyan"
        git clone --depth 1 https://github.com/danielmiessler/SecLists.git "$Script:ToolsDir\Wordlists\SecLists" 2>$null
    }

    # PayloadsAllTheThings
    if (!(Test-Path "$Script:ToolsDir\Wordlists\PayloadsAllTheThings")) {
        Write-OutputToGUI "Cloning PayloadsAllTheThings..." "Cyan"
        git clone --depth 1 https://github.com/swisskyrepo/PayloadsAllTheThings.git "$Script:ToolsDir\Wordlists\PayloadsAllTheThings" 2>$null
    }

    # Rockyou
    if (!(Test-Path "$Script:ToolsDir\Wordlists\rockyou.txt")) {
        Write-OutputToGUI "Downloading rockyou.txt..." "Cyan"
        Invoke-WebRequest -Uri "https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt" -OutFile "$Script:ToolsDir\Wordlists\rockyou.txt" 2>$null
    }
}

function Setup-PathIntegration {
    Write-OutputToGUI "`n[+] PHASE 8: Setting up PATH and Environment for CLI Access" "Yellow"

    # Get GOPATH
    $goPath = go env GOPATH
    if (!$goPath) { $goPath = "$env:USERPROFILE\go" }

    # Add all necessary paths
    $pathsToAdd = @(
        "$goPath\bin",
        $Script:BinDir,
        "$Script:ToolsDir\Scripts",
        "$Script:ToolsDir\NetworkScanning\Responder",
        "$Script:ToolsDir\Exploitation\SET"
    )

    # Get current user PATH
    $currentPath = [Environment]::GetEnvironmentVariable("Path", "User")

    # Add paths if not already present
    foreach ($path in $pathsToAdd) {
        if (Test-Path $path) {
            if ($currentPath -notlike "*$path*") {
                Write-OutputToGUI "Adding $path to PATH..." "Cyan"
                $currentPath = "$currentPath;$path"
            }
        }
    }

    # Update PATH
    [Environment]::SetEnvironmentVariable("Path", $currentPath, "User")
    [Environment]::SetEnvironmentVariable("PENTEST_HOME", $Script:ToolsDir, "User")

    # Create wrapper scripts
    Write-OutputToGUI "`n[+] Creating CLI wrapper scripts..." "Yellow"

    # Nikto wrapper
    $niktoScript = @"
@echo off
perl $Script:ToolsDir\WebApplications\nikto\program\nikto.pl %*
"@
    $niktoScript | Out-File "$Script:BinDir\nikto.bat" -Encoding ASCII

    # Create PowerShell profile additions
    $profileAdditions = @"

# PenTest Tools PATH additions
`$env:PENTEST_HOME = "$Script:ToolsDir"
`$env:PATH += ";$goPath\bin;$Script:BinDir"

# Aliases for common pentest tools
Set-Alias nikto "$Script:BinDir\nikto.bat"

# Quick navigation functions
function pentesthome { Set-Location "$Script:ToolsDir" }
function wordlists { Set-Location "$Script:ToolsDir\Wordlists" }
function scripts { Set-Location "$Script:ToolsDir\Scripts" }
function reports { Set-Location "$Script:ToolsDir\Reports" }

Write-Host "PenTest Toolkit loaded. Type 'pentesthome' to navigate to tools directory." -ForegroundColor Green
"@

    $profilePath = $PROFILE.CurrentUserAllHosts
    if (!(Test-Path $profilePath)) {
        New-Item -Path $profilePath -ItemType File -Force | Out-Null
    }
    Add-Content -Path $profilePath -Value $profileAdditions

    # Final refresh
    refreshenv
}

function Run-FullInstallation {
    Write-OutputToGUI "============================================================" "Cyan"
    Write-OutputToGUI "  STARTING COMPLETE 2025 PENTEST TOOLKIT INSTALLATION" "Cyan"
    Write-OutputToGUI "  THIS MAY TAKE 30-60 MINUTES" "Cyan"
    Write-OutputToGUI "============================================================" "Cyan"

    try {
        Install-Chocolatey
        Setup-DirectoryStructure
        Install-NetworkTools
        Install-WebTools
        Install-PasswordTools
        Install-DevelopmentTools
        Install-PythonTools
        Install-GoTools
        Install-Wordlists
        Setup-PathIntegration

        Write-OutputToGUI "`n============================================================" "Green"
        Write-OutputToGUI "  COMPLETE! ALL 2025 TOOLS INSTALLED & CLI READY" "Green"
        Write-OutputToGUI "============================================================" "Green"
        Write-OutputToGUI "`nINSTALLED TOOL CATEGORIES:" "Cyan"
        Write-OutputToGUI "  ‚úì Network Scanning (Nmap, Masscan, Wireshark, Zenmap)" "White"
        Write-OutputToGUI "  ‚úì Web Testing (Burp, ZAP, Nikto, Sqlmap, GoBuster)" "White"
        Write-OutputToGUI "  ‚úì Password Cracking (Hashcat, John, Hydra)" "White"
        Write-OutputToGUI "  ‚úì Development (Python, Go, Ruby, Git, VSCode)" "White"
        Write-OutputToGUI "  ‚úì 40+ Go Recon Tools (Nuclei, Subfinder, FFuf, etc.)" "White"
        Write-OutputToGUI "  ‚úì 80+ Python Tools (Impacket, CrackMapExec, etc.)" "White"
        Write-OutputToGUI "  ‚úì Complete Wordlists (SecLists, PayloadsAllTheThings, Rockyou)" "White"

        Write-OutputToGUI "`nTOOL DIRECTORY: $Script:ToolsDir" "Yellow"
        Write-OutputToGUI "BIN DIRECTORY: $Script:BinDir" "Yellow"

        # Update tool status after installation
        foreach ($tool in $Script:AllTools.Keys) {
            Test-ToolInstallation -ToolName $tool
        }

    } catch {
        Write-OutputToGUI "‚ùå Installation failed: $($_.Exception.Message)" "Red"
    }
}

# ========== INITIALIZATION ==========
Write-Host "Initializing Ultimate Penetration Testing Framework..." -ForegroundColor Cyan

# Enhanced setup with manual control
if (Show-SetupWizard) {
    # Check admin privileges
    if (!(Test-AdminPrivileges)) {
        Write-Warning "Not running as Administrator. Some features may be limited."
    }

    # Create necessary directories
    $directories = @(
        $Script:UserSettings.DefaultOutputDir,
        "$($Script:UserSettings.DefaultOutputDir)\Payloads", 
        "$($Script:UserSettings.DefaultOutputDir)\Scans",
        "$($Script:UserSettings.DefaultOutputDir)\Wordlists",
        "$($Script:UserSettings.DefaultOutputDir)\Results"
    )

    foreach ($dir in $directories) {
        if (!(Test-Path $dir)) {
            New-Item -ItemType Directory -Path $dir -Force | Out-Null
        }
    }

    # Ask if user wants full installation
    $installResult = [System.Windows.Forms.MessageBox]::Show(
        "Do you want to run the FULL AUTOMATED INSTALLATION now?`n`nThis will install 150+ tools and may take 30-60 minutes.`n`nYou can also install tools individually later using the Tool Manager.", 
        "Full Installation", 
        [System.Windows.Forms.MessageBoxButtons]::YesNo, 
        [System.Windows.Forms.MessageBoxIcon]::Question
    )
    
    if ($installResult -eq [System.Windows.Forms.DialogResult]::Yes) {
        Run-FullInstallation
    } else {
        Write-OutputToGUI "‚è© Skipping full installation. Use Tool Manager to install individual tools." "Yellow"
    }

    # Initialize tool status
    Write-OutputToGUI "Checking tool installations..." "Yellow"
    foreach ($tool in $Script:AllTools.Keys) {
        Test-ToolInstallation -ToolName $tool
    }

    # Start the GUI
    Show-MainGUI
} else {
    Write-Host "Setup cancelled by user." -ForegroundColor Yellow
}

Write-Host "`nPenetration Testing Framework completed." -ForegroundColor Green